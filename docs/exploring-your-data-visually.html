<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Exploring your data visually | FST 5984: SS Data Analytics for Food and Ag Science</title>
  <meta name="description" content="<p>This bookdown is the compiled and unedited lectures from the Spring 2022
Virginia Tech Course FST 5984: SS Data Analytics for Food and Ag Science.</p>" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Exploring your data visually | FST 5984: SS Data Analytics for Food and Ag Science" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This bookdown is the compiled and unedited lectures from the Spring 2022
Virginia Tech Course FST 5984: SS Data Analytics for Food and Ag Science.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Exploring your data visually | FST 5984: SS Data Analytics for Food and Ag Science" />
  
  <meta name="twitter:description" content="<p>This bookdown is the compiled and unedited lectures from the Spring 2022
Virginia Tech Course FST 5984: SS Data Analytics for Food and Ag Science.</p>" />
  

<meta name="author" content="Jacob Lahne" />


<meta name="date" content="2022-07-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="wrangling-your-data.html"/>
<link rel="next" href="describing-your-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data analytics for food and ag science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i>Course description</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-learning-objectives"><i class="fa fa-check"></i>Course Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-should-i-do-with-this-material"><i class="fa fa-check"></i>What should I do with this material?</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="day-1---welcome-to-fst-5984-2022.html"><a href="day-1---welcome-to-fst-5984-2022.html"><i class="fa fa-check"></i><b>1</b> Day 1 - Welcome to FST 5984 (2022)</a>
<ul>
<li class="chapter" data-level="1.0.1" data-path="day-1---welcome-to-fst-5984-2022.html"><a href="day-1---welcome-to-fst-5984-2022.html#syllabus-review"><i class="fa fa-check"></i><b>1.0.1</b> Syllabus Review</a></li>
<li class="chapter" data-level="1.0.2" data-path="day-1---welcome-to-fst-5984-2022.html"><a href="day-1---welcome-to-fst-5984-2022.html#getting-set-up-for-class"><i class="fa fa-check"></i><b>1.0.2</b> Getting set up for class</a></li>
<li class="chapter" data-level="1.1" data-path="day-1---welcome-to-fst-5984-2022.html"><a href="day-1---welcome-to-fst-5984-2022.html#coding"><i class="fa fa-check"></i><b>1.1</b> Coding</a></li>
<li class="chapter" data-level="1.2" data-path="day-1---welcome-to-fst-5984-2022.html"><a href="day-1---welcome-to-fst-5984-2022.html#how-to-make-errors-and-annoy-computers"><i class="fa fa-check"></i><b>1.2</b> How to make errors and annoy computers</a></li>
<li class="chapter" data-level="1.3" data-path="day-1---welcome-to-fst-5984-2022.html"><a href="day-1---welcome-to-fst-5984-2022.html#inputs-and-data-types-in-r"><i class="fa fa-check"></i><b>1.3</b> Inputs and data types in R</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="day-1---welcome-to-fst-5984-2022.html"><a href="day-1---welcome-to-fst-5984-2022.html#whitespace"><i class="fa fa-check"></i><b>1.3.1</b> Whitespace</a></li>
<li class="chapter" data-level="1.3.2" data-path="day-1---welcome-to-fst-5984-2022.html"><a href="day-1---welcome-to-fst-5984-2022.html#data-types"><i class="fa fa-check"></i><b>1.3.2</b> Data types</a></li>
<li class="chapter" data-level="1.3.3" data-path="day-1---welcome-to-fst-5984-2022.html"><a href="day-1---welcome-to-fst-5984-2022.html#ok-but-what-kind-of-object-is-print-then"><i class="fa fa-check"></i><b>1.3.3</b> Ok, but what kind of object <em>is</em> <code>print()</code> then?</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="day-1---welcome-to-fst-5984-2022.html"><a href="day-1---welcome-to-fst-5984-2022.html#metacognition-learning-to-learn-in-r"><i class="fa fa-check"></i><b>1.4</b> Metacognition: Learning to Learn in R</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="extending-r-with-packages-and-r-markdown.html"><a href="extending-r-with-packages-and-r-markdown.html"><i class="fa fa-check"></i><b>2</b> Extending R with packages and R Markdown</a>
<ul>
<li class="chapter" data-level="2.1" data-path="extending-r-with-packages-and-r-markdown.html"><a href="extending-r-with-packages-and-r-markdown.html#all-about-r-markdown"><i class="fa fa-check"></i><b>2.1</b> All about R Markdown</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="extending-r-with-packages-and-r-markdown.html"><a href="extending-r-with-packages-and-r-markdown.html#what-is-an-r-script"><i class="fa fa-check"></i><b>2.1.1</b> What is an R script?</a></li>
<li class="chapter" data-level="2.1.2" data-path="extending-r-with-packages-and-r-markdown.html"><a href="extending-r-with-packages-and-r-markdown.html#how-do-we-make-an-r-markdown-document"><i class="fa fa-check"></i><b>2.1.2</b> How do we make an R Markdown document?</a></li>
<li class="chapter" data-level="2.1.3" data-path="extending-r-with-packages-and-r-markdown.html"><a href="extending-r-with-packages-and-r-markdown.html#elements-of-r-markdown-documents"><i class="fa fa-check"></i><b>2.1.3</b> Elements of R Markdown documents</a></li>
<li class="chapter" data-level="2.1.4" data-path="extending-r-with-packages-and-r-markdown.html"><a href="extending-r-with-packages-and-r-markdown.html#knitting-r-markdown-documents"><i class="fa fa-check"></i><b>2.1.4</b> “Knitting” R Markdown documents</a></li>
<li class="chapter" data-level="2.1.5" data-path="extending-r-with-packages-and-r-markdown.html"><a href="extending-r-with-packages-and-r-markdown.html#joplin---an-easy-way-to-learn-basic-markdown"><i class="fa fa-check"></i><b>2.1.5</b> Joplin - an easy way to learn basic Markdown</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="extending-r-with-packages-and-r-markdown.html"><a href="extending-r-with-packages-and-r-markdown.html#extending-r---packages"><i class="fa fa-check"></i><b>2.2</b> Extending R - Packages</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="extending-r-with-packages-and-r-markdown.html"><a href="extending-r-with-packages-and-r-markdown.html#what-are-packages"><i class="fa fa-check"></i><b>2.2.1</b> What are packages?</a></li>
<li class="chapter" data-level="2.2.2" data-path="extending-r-with-packages-and-r-markdown.html"><a href="extending-r-with-packages-and-r-markdown.html#installing-packages"><i class="fa fa-check"></i><b>2.2.2</b> Installing packages</a></li>
<li class="chapter" data-level="2.2.3" data-path="extending-r-with-packages-and-r-markdown.html"><a href="extending-r-with-packages-and-r-markdown.html#using-packages"><i class="fa fa-check"></i><b>2.2.3</b> Using packages</a></li>
<li class="chapter" data-level="2.2.4" data-path="extending-r-with-packages-and-r-markdown.html"><a href="extending-r-with-packages-and-r-markdown.html#detaching-unloading-packages"><i class="fa fa-check"></i><b>2.2.4</b> Detaching (unloading) packages</a></li>
<li class="chapter" data-level="2.2.5" data-path="extending-r-with-packages-and-r-markdown.html"><a href="extending-r-with-packages-and-r-markdown.html#uninstalling-packages"><i class="fa fa-check"></i><b>2.2.5</b> Uninstalling packages</a></li>
<li class="chapter" data-level="2.2.6" data-path="extending-r-with-packages-and-r-markdown.html"><a href="extending-r-with-packages-and-r-markdown.html#getting-help---a-deeper-drive"><i class="fa fa-check"></i><b>2.2.6</b> Getting help - a deeper drive</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="extending-r-with-packages-and-r-markdown.html"><a href="extending-r-with-packages-and-r-markdown.html#complex-r-objects"><i class="fa fa-check"></i><b>2.3</b> Complex R Objects</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="extending-r-with-packages-and-r-markdown.html"><a href="extending-r-with-packages-and-r-markdown.html#vectors-a-review"><i class="fa fa-check"></i><b>2.3.1</b> Vectors: a review</a></li>
<li class="chapter" data-level="2.3.2" data-path="extending-r-with-packages-and-r-markdown.html"><a href="extending-r-with-packages-and-r-markdown.html#vector-math"><i class="fa fa-check"></i><b>2.3.2</b> Vector math</a></li>
<li class="chapter" data-level="2.3.3" data-path="extending-r-with-packages-and-r-markdown.html"><a href="extending-r-with-packages-and-r-markdown.html#indexing-getting-elements-from-a-vector"><i class="fa fa-check"></i><b>2.3.3</b> “Indexing”: getting elements from a vector</a></li>
<li class="chapter" data-level="2.3.4" data-path="extending-r-with-packages-and-r-markdown.html"><a href="extending-r-with-packages-and-r-markdown.html#multidimensional-vectors-matrices-and-arrays"><i class="fa fa-check"></i><b>2.3.4</b> Multidimensional vectors: Matrices and Arrays</a></li>
<li class="chapter" data-level="2.3.5" data-path="extending-r-with-packages-and-r-markdown.html"><a href="extending-r-with-packages-and-r-markdown.html#lists-non-atomic-vectors"><i class="fa fa-check"></i><b>2.3.5</b> Lists: non-atomic vectors</a></li>
<li class="chapter" data-level="2.3.6" data-path="extending-r-with-packages-and-r-markdown.html"><a href="extending-r-with-packages-and-r-markdown.html#data.frame-tables-of-data"><i class="fa fa-check"></i><b>2.3.6</b> <code>data.frame</code>: Tables of data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="control-flow-and-functions.html"><a href="control-flow-and-functions.html"><i class="fa fa-check"></i><b>3</b> Control flow and functions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="control-flow-and-functions.html"><a href="control-flow-and-functions.html#functions"><i class="fa fa-check"></i><b>3.1</b> Functions</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="control-flow-and-functions.html"><a href="control-flow-and-functions.html#introduction---quasi-mathematical-definition"><i class="fa fa-check"></i><b>3.1.1</b> Introduction - quasi-mathematical definition</a></li>
<li class="chapter" data-level="3.1.2" data-path="control-flow-and-functions.html"><a href="control-flow-and-functions.html#everything-weve-been-using-in-r-is-a-function"><i class="fa fa-check"></i><b>3.1.2</b> Everything we’ve been using in R is a function</a></li>
<li class="chapter" data-level="3.1.3" data-path="control-flow-and-functions.html"><a href="control-flow-and-functions.html#back-to-reading-the-function-structure"><i class="fa fa-check"></i><b>3.1.3</b> Back to <code>?</code>: Reading the function structure</a></li>
<li class="chapter" data-level="3.1.4" data-path="control-flow-and-functions.html"><a href="control-flow-and-functions.html#function-arguments"><i class="fa fa-check"></i><b>3.1.4</b> Function arguments</a></li>
<li class="chapter" data-level="3.1.5" data-path="control-flow-and-functions.html"><a href="control-flow-and-functions.html#writing-your-own-functions"><i class="fa fa-check"></i><b>3.1.5</b> Writing your own functions</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="control-flow-and-functions.html"><a href="control-flow-and-functions.html#control-structure---making-your-code-hustle-and-flow"><i class="fa fa-check"></i><b>3.2</b> Control structure - making your code hustle and flow</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="control-flow-and-functions.html"><a href="control-flow-and-functions.html#write-what-you-want-pseudo-code"><i class="fa fa-check"></i><b>3.2.1</b> Write-what-you-want: Pseudo Code</a></li>
<li class="chapter" data-level="3.2.2" data-path="control-flow-and-functions.html"><a href="control-flow-and-functions.html#logical-conditions"><i class="fa fa-check"></i><b>3.2.2</b> Logical conditions</a></li>
<li class="chapter" data-level="3.2.3" data-path="control-flow-and-functions.html"><a href="control-flow-and-functions.html#conditional-statements"><i class="fa fa-check"></i><b>3.2.3</b> Conditional statements</a></li>
<li class="chapter" data-level="3.2.4" data-path="control-flow-and-functions.html"><a href="control-flow-and-functions.html#if-statements"><i class="fa fa-check"></i><b>3.2.4</b> IF statements</a></li>
<li class="chapter" data-level="3.2.5" data-path="control-flow-and-functions.html"><a href="control-flow-and-functions.html#loops"><i class="fa fa-check"></i><b>3.2.5</b> Loops</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="control-flow-and-functions.html"><a href="control-flow-and-functions.html#simulating-and-sampling-data-in-r"><i class="fa fa-check"></i><b>3.3</b> Simulating and sampling data in R</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="control-flow-and-functions.html"><a href="control-flow-and-functions.html#why-simulation-is-important"><i class="fa fa-check"></i><b>3.3.1</b> Why simulation is important</a></li>
<li class="chapter" data-level="3.3.2" data-path="control-flow-and-functions.html"><a href="control-flow-and-functions.html#predictable-sequences"><i class="fa fa-check"></i><b>3.3.2</b> Predictable sequences</a></li>
<li class="chapter" data-level="3.3.3" data-path="control-flow-and-functions.html"><a href="control-flow-and-functions.html#random-numbers"><i class="fa fa-check"></i><b>3.3.3</b> “Random” numbers</a></li>
<li class="chapter" data-level="3.3.4" data-path="control-flow-and-functions.html"><a href="control-flow-and-functions.html#sampling-from-existing-data"><i class="fa fa-check"></i><b>3.3.4</b> Sampling from existing data</a></li>
<li class="chapter" data-level="3.3.5" data-path="control-flow-and-functions.html"><a href="control-flow-and-functions.html#summary---sampling-and-simulation"><i class="fa fa-check"></i><b>3.3.5</b> Summary - sampling and simulation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="control-flow-and-functions.html"><a href="control-flow-and-functions.html#references"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="wrangling-your-data.html"><a href="wrangling-your-data.html"><i class="fa fa-check"></i><b>4</b> Wrangling your data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="wrangling-your-data.html"><a href="wrangling-your-data.html#getting-your-data-into-r"><i class="fa fa-check"></i><b>4.1</b> Getting your data into R</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="wrangling-your-data.html"><a href="wrangling-your-data.html#data-storage-outside-r"><i class="fa fa-check"></i><b>4.1.1</b> Data storage <em>outside</em> R</a></li>
<li class="chapter" data-level="4.1.2" data-path="wrangling-your-data.html"><a href="wrangling-your-data.html#read.table"><i class="fa fa-check"></i><b>4.1.2</b> <code>read.table()</code></a></li>
<li class="chapter" data-level="4.1.3" data-path="wrangling-your-data.html"><a href="wrangling-your-data.html#read.csv"><i class="fa fa-check"></i><b>4.1.3</b> <code>read.csv()</code></a></li>
<li class="chapter" data-level="4.1.4" data-path="wrangling-your-data.html"><a href="wrangling-your-data.html#hard"><i class="fa fa-check"></i><b>4.1.4</b> Why data storage is hard</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="wrangling-your-data.html"><a href="wrangling-your-data.html#making-your-life-in-r-easier-with-the-tidyverse"><i class="fa fa-check"></i><b>4.2</b> Making your life in R easier with the <code>tidyverse</code></a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="wrangling-your-data.html"><a href="wrangling-your-data.html#naming-long-tidy-vs-wide-data"><i class="fa fa-check"></i><b>4.2.1</b> Naming: long (“tidy”) vs wide data</a></li>
<li class="chapter" data-level="4.2.2" data-path="wrangling-your-data.html"><a href="wrangling-your-data.html#one-pipe-to-rule-them-all"><i class="fa fa-check"></i><b>4.2.2</b> One pipe to rule them all: <code>%&gt;%</code></a></li>
<li class="chapter" data-level="4.2.3" data-path="wrangling-your-data.html"><a href="wrangling-your-data.html#tibble"><i class="fa fa-check"></i><b>4.2.3</b> The <code>tibble()</code></a></li>
<li class="chapter" data-level="4.2.4" data-path="wrangling-your-data.html"><a href="wrangling-your-data.html#select"><i class="fa fa-check"></i><b>4.2.4</b> Pick columns: <code>select()</code></a></li>
<li class="chapter" data-level="4.2.5" data-path="wrangling-your-data.html"><a href="wrangling-your-data.html#pick-rows-filter"><i class="fa fa-check"></i><b>4.2.5</b> Pick rows: <code>filter()</code></a></li>
<li class="chapter" data-level="4.2.6" data-path="wrangling-your-data.html"><a href="wrangling-your-data.html#make-new-columns-mutate"><i class="fa fa-check"></i><b>4.2.6</b> Make new columns: <code>mutate()</code></a></li>
<li class="chapter" data-level="4.2.7" data-path="wrangling-your-data.html"><a href="wrangling-your-data.html#create-quick-data-summaries-group_by-count-and-summarize"><i class="fa fa-check"></i><b>4.2.7</b> Create quick data summaries: <code>group_by()</code>, <code>count()</code>, and <code>summarize()</code></a></li>
<li class="chapter" data-level="4.2.8" data-path="wrangling-your-data.html"><a href="wrangling-your-data.html#utilities-for-data-management"><i class="fa fa-check"></i><b>4.2.8</b> Utilities for data management</a></li>
<li class="chapter" data-level="4.2.9" data-path="wrangling-your-data.html"><a href="wrangling-your-data.html#reading-data-tidily-read_"><i class="fa fa-check"></i><b>4.2.9</b> Reading data tidily: <code>read_*()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="wrangling-your-data.html"><a href="wrangling-your-data.html#review-of-functions"><i class="fa fa-check"></i><b>4.3</b> Review of functions</a></li>
<li class="chapter" data-level="" data-path="wrangling-your-data.html"><a href="wrangling-your-data.html#references-1"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="exploring-your-data-visually.html"><a href="exploring-your-data-visually.html"><i class="fa fa-check"></i><b>5</b> Exploring your data visually</a>
<ul>
<li class="chapter" data-level="5.1" data-path="exploring-your-data-visually.html"><a href="exploring-your-data-visually.html#reasons-for-developing-competency-with-data-visualization"><i class="fa fa-check"></i><b>5.1</b> Reasons for developing competency with data visualization</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="exploring-your-data-visually.html"><a href="exploring-your-data-visually.html#to-help-you-explore-your-data"><i class="fa fa-check"></i><b>5.1.1</b> To help you explore your data</a></li>
<li class="chapter" data-level="5.1.2" data-path="exploring-your-data-visually.html"><a href="exploring-your-data-visually.html#stakeholders"><i class="fa fa-check"></i><b>5.1.2</b> For communication to stakeholders</a></li>
<li class="chapter" data-level="5.1.3" data-path="exploring-your-data-visually.html"><a href="exploring-your-data-visually.html#for-argumentation"><i class="fa fa-check"></i><b>5.1.3</b> For argumentation</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="exploring-your-data-visually.html"><a href="exploring-your-data-visually.html#plotting-in-base-r"><i class="fa fa-check"></i><b>5.2</b> Plotting in base R</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="exploring-your-data-visually.html"><a href="exploring-your-data-visually.html#histograms-with-hist"><i class="fa fa-check"></i><b>5.2.1</b> Histograms with <code id="histograms">hist()</code></a></li>
<li class="chapter" data-level="5.2.2" data-path="exploring-your-data-visually.html"><a href="exploring-your-data-visually.html#boxplots-with-boxplot"><i class="fa fa-check"></i><b>5.2.2</b> Boxplots with <code>boxplot()</code></a></li>
<li class="chapter" data-level="5.2.3" data-path="exploring-your-data-visually.html"><a href="exploring-your-data-visually.html#generic-plot"><i class="fa fa-check"></i><b>5.2.3</b> Generic <code>plot()</code></a></li>
<li class="chapter" data-level="5.2.4" data-path="exploring-your-data-visually.html"><a href="exploring-your-data-visually.html#saving-plots-to-file"><i class="fa fa-check"></i><b>5.2.4</b> Saving plots to file</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="exploring-your-data-visually.html"><a href="exploring-your-data-visually.html#the-grammar-of-graphics-ggplot2"><i class="fa fa-check"></i><b>5.3</b> The ‘grammar of graphics’: <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="exploring-your-data-visually.html"><a href="exploring-your-data-visually.html#anatomy-of-a-ggplot"><i class="fa fa-check"></i><b>5.3.1</b> Anatomy of a <code>ggplot()</code></a></li>
<li class="chapter" data-level="5.3.2" data-path="exploring-your-data-visually.html"><a href="exploring-your-data-visually.html#common-recipes-for-basic-tasks"><i class="fa fa-check"></i><b>5.3.2</b> Common recipes for basic tasks</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="exploring-your-data-visually.html"><a href="exploring-your-data-visually.html#tidy"><i class="fa fa-check"></i><b>5.4</b> Return to data wrangling - long vs wide</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="exploring-your-data-visually.html"><a href="exploring-your-data-visually.html#making-data-tidy"><i class="fa fa-check"></i><b>5.4.1</b> Making data tidy</a></li>
<li class="chapter" data-level="5.4.2" data-path="exploring-your-data-visually.html"><a href="exploring-your-data-visually.html#making-data-wide"><i class="fa fa-check"></i><b>5.4.2</b> Making data wide</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exploring-your-data-visually.html"><a href="exploring-your-data-visually.html#references-2"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="describing-your-data.html"><a href="describing-your-data.html"><i class="fa fa-check"></i><b>6</b> Describing your data</a>
<ul>
<li class="chapter" data-level="6.1" data-path="describing-your-data.html"><a href="describing-your-data.html#datasets"><i class="fa fa-check"></i><b>6.1</b> Datasets</a></li>
<li class="chapter" data-level="6.2" data-path="describing-your-data.html"><a href="describing-your-data.html#review-exercise-how-did-i-import-these-datasets"><i class="fa fa-check"></i><b>6.2</b> Review exercise: How did I import these datasets?</a></li>
<li class="chapter" data-level="6.3" data-path="describing-your-data.html"><a href="describing-your-data.html#what-kind-of-data-do-you-have"><i class="fa fa-check"></i><b>6.3</b> What kind of data do you have?</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="describing-your-data.html"><a href="describing-your-data.html#basic-attributes"><i class="fa fa-check"></i><b>6.3.1</b> Basic attributes</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="describing-your-data.html"><a href="describing-your-data.html#examining-big-data-frames"><i class="fa fa-check"></i><b>6.4</b> Examining big data frames</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="describing-your-data.html"><a href="describing-your-data.html#dplyrglimpse"><i class="fa fa-check"></i><b>6.4.1</b> <code>dplyr::glimpse()</code></a></li>
<li class="chapter" data-level="6.4.2" data-path="describing-your-data.html"><a href="describing-your-data.html#headtail"><i class="fa fa-check"></i><b>6.4.2</b> <code>head()</code>/<code>tail()</code></a></li>
<li class="chapter" data-level="6.4.3" data-path="describing-your-data.html"><a href="describing-your-data.html#dplyrslice_"><i class="fa fa-check"></i><b>6.4.3</b> <code>dplyr::slice_*()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="describing-your-data.html"><a href="describing-your-data.html#generating-data-summaries"><i class="fa fa-check"></i><b>6.5</b> Generating data summaries</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="describing-your-data.html"><a href="describing-your-data.html#summary-1"><i class="fa fa-check"></i><b>6.5.1</b> <code>summary()</code></a></li>
<li class="chapter" data-level="6.5.2" data-path="describing-your-data.html"><a href="describing-your-data.html#skimrskim"><i class="fa fa-check"></i><b>6.5.2</b> <code>skimr::skim()</code></a></li>
<li class="chapter" data-level="6.5.3" data-path="describing-your-data.html"><a href="describing-your-data.html#group_by-and-summarizecount"><i class="fa fa-check"></i><b>6.5.3</b> <code>group_by()</code> and <code>summarize()</code>/<code>count()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="describing-your-data.html"><a href="describing-your-data.html#statistics-review"><i class="fa fa-check"></i><b>6.6</b> Statistics review</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="describing-your-data.html"><a href="describing-your-data.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>6.6.1</b> Measures of central tendency</a></li>
<li class="chapter" data-level="6.6.2" data-path="describing-your-data.html"><a href="describing-your-data.html#variation"><i class="fa fa-check"></i><b>6.6.2</b> Variation</a></li>
<li class="chapter" data-level="6.6.3" data-path="describing-your-data.html"><a href="describing-your-data.html#linear-association"><i class="fa fa-check"></i><b>6.6.3</b> Linear Association</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="describing-your-data.html"><a href="describing-your-data.html#references-3"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="advancing-our-wrangling.html"><a href="advancing-our-wrangling.html"><i class="fa fa-check"></i><b>7</b> Advancing our wrangling</a>
<ul>
<li class="chapter" data-level="7.1" data-path="advancing-our-wrangling.html"><a href="advancing-our-wrangling.html#todays-data"><i class="fa fa-check"></i><b>7.1</b> Today’s data</a></li>
<li class="chapter" data-level="7.2" data-path="advancing-our-wrangling.html"><a href="advancing-our-wrangling.html#review-of-control-flow"><i class="fa fa-check"></i><b>7.2</b> Review of control flow</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="advancing-our-wrangling.html"><a href="advancing-our-wrangling.html#loops-1"><i class="fa fa-check"></i><b>7.2.1</b> Loops</a></li>
<li class="chapter" data-level="7.2.2" data-path="advancing-our-wrangling.html"><a href="advancing-our-wrangling.html#conditionals"><i class="fa fa-check"></i><b>7.2.2</b> Conditionals</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="advancing-our-wrangling.html"><a href="advancing-our-wrangling.html#using-vectorization-in-r"><i class="fa fa-check"></i><b>7.3</b> Using vectorization in R</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="advancing-our-wrangling.html"><a href="advancing-our-wrangling.html#tidyverse-approaches-map-family"><i class="fa fa-check"></i><b>7.3.1</b> <code>tidyverse</code> approaches: <code>map()</code> family</a></li>
<li class="chapter" data-level="7.3.2" data-path="advancing-our-wrangling.html"><a href="advancing-our-wrangling.html#base-r-approaches-apply-family"><i class="fa fa-check"></i><b>7.3.2</b> Base R approaches: <code>apply()</code> family</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="advancing-our-wrangling.html"><a href="advancing-our-wrangling.html#relational-data"><i class="fa fa-check"></i><b>7.4</b> Relational data</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="advancing-our-wrangling.html"><a href="advancing-our-wrangling.html#bind-functions"><i class="fa fa-check"></i><b>7.4.1</b> <code>*bind()</code> functions</a></li>
<li class="chapter" data-level="7.4.2" data-path="advancing-our-wrangling.html"><a href="advancing-our-wrangling.html#join-functions"><i class="fa fa-check"></i><b>7.4.2</b> <code>*_join()</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="advancing-our-wrangling.html"><a href="advancing-our-wrangling.html#writing-readable-and-reproducible-scripts"><i class="fa fa-check"></i><b>7.5</b> Writing readable and reproducible scripts</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="advancing-our-wrangling.html"><a href="advancing-our-wrangling.html#comments"><i class="fa fa-check"></i><b>7.5.1</b> Comments</a></li>
<li class="chapter" data-level="7.5.2" data-path="advancing-our-wrangling.html"><a href="advancing-our-wrangling.html#whitespace-1"><i class="fa fa-check"></i><b>7.5.2</b> Whitespace</a></li>
<li class="chapter" data-level="7.5.3" data-path="advancing-our-wrangling.html"><a href="advancing-our-wrangling.html#use-informative-variable-names"><i class="fa fa-check"></i><b>7.5.3</b> Use informative variable names</a></li>
<li class="chapter" data-level="7.5.4" data-path="advancing-our-wrangling.html"><a href="advancing-our-wrangling.html#running-from-scratch"><i class="fa fa-check"></i><b>7.5.4</b> Running from scratch</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="advancing-our-wrangling.html"><a href="advancing-our-wrangling.html#references-4"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="inference-from-data.html"><a href="inference-from-data.html"><i class="fa fa-check"></i><b>8</b> Inference from data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="inference-from-data.html"><a href="inference-from-data.html#motivation-inference-from-experiments"><i class="fa fa-check"></i><b>8.1</b> Motivation: inference from experiments</a></li>
<li class="chapter" data-level="8.2" data-path="inference-from-data.html"><a href="inference-from-data.html#a-resampling-approach-to-statistics"><i class="fa fa-check"></i><b>8.2</b> “A resampling approach” to statistics</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="inference-from-data.html"><a href="inference-from-data.html#confidence-intervals-around-group-means-the-bootstrap"><i class="fa fa-check"></i><b>8.2.1</b> Confidence intervals around group means (the “bootstrap”)</a></li>
<li class="chapter" data-level="8.2.2" data-path="inference-from-data.html"><a href="inference-from-data.html#is-that-difference-important-permutation-tests"><i class="fa fa-check"></i><b>8.2.2</b> Is that difference important (permutation tests)?</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="inference-from-data.html"><a href="inference-from-data.html#what-do-we-know-about-statistics"><i class="fa fa-check"></i><b>8.3</b> What do we know about statistics?</a></li>
<li class="chapter" data-level="" data-path="inference-from-data.html"><a href="inference-from-data.html#references-5"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="the-linear-model---regression-and-anova.html"><a href="the-linear-model---regression-and-anova.html"><i class="fa fa-check"></i><b>9</b> The linear model - regression and ANOVA</a>
<ul>
<li class="chapter" data-level="9.1" data-path="the-linear-model---regression-and-anova.html"><a href="the-linear-model---regression-and-anova.html#dataset-example-for-today"><i class="fa fa-check"></i><b>9.1</b> Dataset example for today</a></li>
<li class="chapter" data-level="9.2" data-path="the-linear-model---regression-and-anova.html"><a href="the-linear-model---regression-and-anova.html#review-of-measurement-levels"><i class="fa fa-check"></i><b>9.2</b> Review of measurement levels</a></li>
<li class="chapter" data-level="9.3" data-path="the-linear-model---regression-and-anova.html"><a href="the-linear-model---regression-and-anova.html#linear-regression"><i class="fa fa-check"></i><b>9.3</b> Linear regression</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="the-linear-model---regression-and-anova.html"><a href="the-linear-model---regression-and-anova.html#bivariate-2-variable-relationships-imply-a-third-variable"><i class="fa fa-check"></i><b>9.3.1</b> Bivariate (2-variable) relationships imply a third variable</a></li>
<li class="chapter" data-level="9.3.2" data-path="the-linear-model---regression-and-anova.html"><a href="the-linear-model---regression-and-anova.html#simple-linear-regression"><i class="fa fa-check"></i><b>9.3.2</b> Simple linear regression</a></li>
<li class="chapter" data-level="9.3.3" data-path="the-linear-model---regression-and-anova.html"><a href="the-linear-model---regression-and-anova.html#checking-your-model"><i class="fa fa-check"></i><b>9.3.3</b> Checking your model</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="the-linear-model---regression-and-anova.html"><a href="the-linear-model---regression-and-anova.html#a-note-about-causality"><i class="fa fa-check"></i><b>9.4</b> A note about causality</a></li>
<li class="chapter" data-level="9.5" data-path="the-linear-model---regression-and-anova.html"><a href="the-linear-model---regression-and-anova.html#a-coding-digression-factor"><i class="fa fa-check"></i><b>9.5</b> A coding digression: <code>factor</code></a></li>
<li class="chapter" data-level="9.6" data-path="the-linear-model---regression-and-anova.html"><a href="the-linear-model---regression-and-anova.html#analysis-of-variance-anova"><i class="fa fa-check"></i><b>9.6</b> Analysis of variance (ANOVA)</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="the-linear-model---regression-and-anova.html"><a href="the-linear-model---regression-and-anova.html#one-way-anova"><i class="fa fa-check"></i><b>9.6.1</b> One-way ANOVA</a></li>
<li class="chapter" data-level="9.6.2" data-path="the-linear-model---regression-and-anova.html"><a href="the-linear-model---regression-and-anova.html#posthoc-testing"><i class="fa fa-check"></i><b>9.6.2</b> Posthoc testing</a></li>
<li class="chapter" data-level="9.6.3" data-path="the-linear-model---regression-and-anova.html"><a href="the-linear-model---regression-and-anova.html#plotting-anova-results"><i class="fa fa-check"></i><b>9.6.3</b> Plotting ANOVA results</a></li>
<li class="chapter" data-level="9.6.4" data-path="the-linear-model---regression-and-anova.html"><a href="the-linear-model---regression-and-anova.html#resampling-approaches-to-anova"><i class="fa fa-check"></i><b>9.6.4</b> Resampling approaches to ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="the-linear-model---regression-and-anova.html"><a href="the-linear-model---regression-and-anova.html#incorporating-multiple-predictors"><i class="fa fa-check"></i><b>9.7</b> Incorporating multiple predictors</a></li>
<li class="chapter" data-level="" data-path="the-linear-model---regression-and-anova.html"><a href="the-linear-model---regression-and-anova.html#references-6"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="dealing-with-multiple-factors.html"><a href="dealing-with-multiple-factors.html"><i class="fa fa-check"></i><b>10</b> Dealing with multiple factors</a>
<ul>
<li class="chapter" data-level="10.1" data-path="dealing-with-multiple-factors.html"><a href="dealing-with-multiple-factors.html#introduction"><i class="fa fa-check"></i><b>10.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="dealing-with-multiple-factors.html"><a href="dealing-with-multiple-factors.html#data-example"><i class="fa fa-check"></i><b>10.1.1</b> Data example</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="dealing-with-multiple-factors.html"><a href="dealing-with-multiple-factors.html#multi-way-anova"><i class="fa fa-check"></i><b>10.2</b> Multi-way ANOVA</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="dealing-with-multiple-factors.html"><a href="dealing-with-multiple-factors.html#stepwise-model-fitting"><i class="fa fa-check"></i><b>10.2.1</b> Stepwise model fitting</a></li>
<li class="chapter" data-level="10.2.2" data-path="dealing-with-multiple-factors.html"><a href="dealing-with-multiple-factors.html#plotting-interaction-effects"><i class="fa fa-check"></i><b>10.2.2</b> Plotting interaction effects</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="dealing-with-multiple-factors.html"><a href="dealing-with-multiple-factors.html#multiple-regression"><i class="fa fa-check"></i><b>10.3</b> Multiple regression</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="dealing-with-multiple-factors.html"><a href="dealing-with-multiple-factors.html#fitting-a-multiple-regression-to-our-model"><i class="fa fa-check"></i><b>10.3.1</b> Fitting a multiple regression to our model</a></li>
<li class="chapter" data-level="10.3.2" data-path="dealing-with-multiple-factors.html"><a href="dealing-with-multiple-factors.html#a-second-example-of-stepwise-model-fitting"><i class="fa fa-check"></i><b>10.3.2</b> A second example of stepwise model fitting</a></li>
<li class="chapter" data-level="10.3.3" data-path="dealing-with-multiple-factors.html"><a href="dealing-with-multiple-factors.html#combining-continuous-and-categorical-data"><i class="fa fa-check"></i><b>10.3.3</b> Combining continuous and categorical data</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="dealing-with-multiple-factors.html"><a href="dealing-with-multiple-factors.html#some-notes-of-caution-on-model-selection"><i class="fa fa-check"></i><b>10.4</b> Some notes of caution on model selection</a></li>
<li class="chapter" data-level="10.5" data-path="dealing-with-multiple-factors.html"><a href="dealing-with-multiple-factors.html#tree"><i class="fa fa-check"></i><b>10.5</b> Categorization and Regression Trees (CART): A data-based approach</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="dealing-with-multiple-factors.html"><a href="dealing-with-multiple-factors.html#regression-trees"><i class="fa fa-check"></i><b>10.5.1</b> Regression trees</a></li>
<li class="chapter" data-level="10.5.2" data-path="dealing-with-multiple-factors.html"><a href="dealing-with-multiple-factors.html#categorization-trees"><i class="fa fa-check"></i><b>10.5.2</b> Categorization trees</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="dealing-with-multiple-factors.html"><a href="dealing-with-multiple-factors.html#wrap-up"><i class="fa fa-check"></i><b>10.6</b> Wrap-up</a></li>
<li class="chapter" data-level="" data-path="dealing-with-multiple-factors.html"><a href="dealing-with-multiple-factors.html#references-7"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="data-literacy-and-an-applied-example-of-data-science.html"><a href="data-literacy-and-an-applied-example-of-data-science.html"><i class="fa fa-check"></i><b>11</b> Data literacy and an applied example of data science</a>
<ul>
<li class="chapter" data-level="11.1" data-path="data-literacy-and-an-applied-example-of-data-science.html"><a href="data-literacy-and-an-applied-example-of-data-science.html#text-mining-and-processing"><i class="fa fa-check"></i><b>11.1</b> Text mining and processing</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="data-literacy-and-an-applied-example-of-data-science.html"><a href="data-literacy-and-an-applied-example-of-data-science.html#introduction-the-data-source"><i class="fa fa-check"></i><b>11.1.1</b> Introduction: the data source</a></li>
<li class="chapter" data-level="11.1.2" data-path="data-literacy-and-an-applied-example-of-data-science.html"><a href="data-literacy-and-an-applied-example-of-data-science.html#getting-permission"><i class="fa fa-check"></i><b>11.1.2</b> Getting permission</a></li>
<li class="chapter" data-level="11.1.3" data-path="data-literacy-and-an-applied-example-of-data-science.html"><a href="data-literacy-and-an-applied-example-of-data-science.html#a-website-is-just-mark-up-language"><i class="fa fa-check"></i><b>11.1.3</b> A website is just (mark up) language</a></li>
<li class="chapter" data-level="11.1.4" data-path="data-literacy-and-an-applied-example-of-data-science.html"><a href="data-literacy-and-an-applied-example-of-data-science.html#looking-at-some-actual-data"><i class="fa fa-check"></i><b>11.1.4</b> Looking at some actual data</a></li>
<li class="chapter" data-level="11.1.5" data-path="data-literacy-and-an-applied-example-of-data-science.html"><a href="data-literacy-and-an-applied-example-of-data-science.html#using-basic-text-analysis-to-find-descriptions"><i class="fa fa-check"></i><b>11.1.5</b> Using basic text analysis to find descriptions</a></li>
<li class="chapter" data-level="11.1.6" data-path="data-literacy-and-an-applied-example-of-data-science.html"><a href="data-literacy-and-an-applied-example-of-data-science.html#quantifying-text-data"><i class="fa fa-check"></i><b>11.1.6</b> Quantifying text data</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="data-literacy-and-an-applied-example-of-data-science.html"><a href="data-literacy-and-an-applied-example-of-data-science.html#data-literacy"><i class="fa fa-check"></i><b>11.2</b> Data literacy</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="data-literacy-and-an-applied-example-of-data-science.html"><a href="data-literacy-and-an-applied-example-of-data-science.html#sources"><i class="fa fa-check"></i><b>11.2.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2.2" data-path="data-literacy-and-an-applied-example-of-data-science.html"><a href="data-literacy-and-an-applied-example-of-data-science.html#the-replicability-crisis"><i class="fa fa-check"></i><b>11.2.2</b> The replicability crisis</a></li>
<li class="chapter" data-level="11.2.3" data-path="data-literacy-and-an-applied-example-of-data-science.html"><a href="data-literacy-and-an-applied-example-of-data-science.html#null"><i class="fa fa-check"></i><b>11.2.3</b> Some quick thoughts on (Null) Hypothesis Testing (NHST)</a></li>
<li class="chapter" data-level="11.2.4" data-path="data-literacy-and-an-applied-example-of-data-science.html"><a href="data-literacy-and-an-applied-example-of-data-science.html#selection"><i class="fa fa-check"></i><b>11.2.4</b> Observer (selection) bias</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="data-literacy-and-an-applied-example-of-data-science.html"><a href="data-literacy-and-an-applied-example-of-data-science.html#counting"><i class="fa fa-check"></i><b>11.3</b> Counting</a></li>
<li class="chapter" data-level="" data-path="data-literacy-and-an-applied-example-of-data-science.html"><a href="data-literacy-and-an-applied-example-of-data-science.html#references-8"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">FST 5984: SS Data Analytics for Food and Ag Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exploring-your-data-visually" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> Exploring your data visually<a href="exploring-your-data-visually.html#exploring-your-data-visually" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>One of the major strengths of R is that it provides a very strong platform for <strong>data visualization</strong> or “dataviz”, if you’re a little bit hurried and willing to be obnoxious. Data visualization, in the last several years, has been an increasing subject of emphasis in statistical and data science classes, a focus of businesses (e.g., the development of specific platforms like <a href="https://www.tableau.com/">Tableau</a>), and a general requirement for working with data.</p>
<p>As sociologist Kieran <span class="citation">Healy (<a href="#ref-healy2019" role="doc-biblioref">2019</a>)</span> <a href="https://socviz.co/index.html#what-you-will-learn">writes</a>:</p>
<blockquote>
<p>You should look at your data. Graphs and charts let you explore and learn about the structure of the information you collect. Good data visualizations also make it easier to communicate your ideas and findings to other people. Beyond that, producing effective plots from your own data is the best way to develop a good eye for reading and understanding graphs—good and bad—made by others, whether presented in research articles, business slide decks, public policy advocacy, or media reports.</p>
</blockquote>
<p>Healy is mirroring advice from one of the main influences in modern, effective statistics and data science: John Tukey (inventor of, among many things, the <strong>box plot</strong>). As historians Michael Friendly and Howard Wainer write <span class="citation">(<a href="#ref-friendly2021" role="doc-biblioref">Friendly and Wainer 2021</a>)</span>:</p>
<blockquote>
<p>John Tukey… revolution[ized] the field of statistics with the idea that the purpose of data analysis was insight, not just numbers, and that insight–seeing the unexpected–more often came from drawing pictures than from proving theorems or deriving equations.</p>
</blockquote>
<div class="figure">
<img src="Images/Week%205/John_Tukey.jpg" id="tukey" alt="" />
<p class="caption">John Tukey, from Wikipedia</p>
</div>
<p>Thus, while <em>dataviz</em> as a subject of increasing concentration is new, the discipline itself isn’t. Famous examples of effective and persuasive data visualization can be traced even farther back than Tukey (unsurprisingly). One of the most famous, in fact, is Florence Nightingale’s work with “rose charts” to document causes of death in the Crimean War in the 1850s, which were credited with causing the British army to modernize sanitation standards. The story (which is fascinating) is described very well in an <a href="https://99percentinvisible.org/episode/florence-nightingale-data-viz-pioneer/">episode of the 99% Invisible podcast</a>:</p>
<div class="figure">
<img src="Images/Week%205/2880px-Nightingale-mortality.jpg" id="nightingale" alt="" />
<p class="caption">Florence Nightingale’s famous “rose charts”, describing causes of mortality in the Crimean theater in the 1850s.</p>
</div>
<p>We can go back even further <span class="citation">(almost to prehistory, according to Friendly and Wainer <a href="#ref-friendly2021" role="doc-biblioref">2021</a>)</span>, but we’ll end with just one more example: what data visualization guru Edward Tufte has called the greatest single graphic in history. The visualization, by Charles Joseph Minard, shows Napoleon’s disastrous invasion of Russia in 1812, in which he lost the majority of his army to the Russian winter.</p>
<div class="figure">
<img src="Images/Week%205/napoleon.png" alt="" />
<p class="caption">Charles Joseph Minard’s data visualization of Napoleon’s invasion of Russia, detailing army size during invasion and retreat, temperature, and geography and time.</p>
</div>
<p>These are classic examples of data visualization that are frequently cited in histories of the subject. But they have survived for a number of reasons: they are clear visualizations of the underlying data, they are aesthetically engaging enough to draw in the reader, and they use the combination of <em>aesthetics</em> and <em>information</em> to make arguments. These are what we want to do when we make data visualizations, which should ideally have these attributes.</p>
<p>As a note, data visualization is related to but not identical with recently popular tools for easily making “infographics”–the latter tend to combine dataviz with design elements to accomplish some of the same points, but are usually meant to be complete documents or other communicative tools on their own. For our purposes we are going to focus on data visualization as a way to make sense of our data.</p>
<div class="figure">
<img src="https://imgs.xkcd.com/comics/tall_infographics.png" alt="" />
<p class="caption"><a href="https://xkcd.com/1273/">XKCD on infographics</a>.</p>
</div>
<p>This week we’re going to focus on the <em>how</em> of plotting data in R. This means I’m not going to try to teach principles for effective dataviz <em>design</em> (a topic I am only marginally competent with), but rather how to turn your data into dataviz.</p>
<div id="reasons-for-developing-competency-with-data-visualization" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Reasons for developing competency with data visualization<a href="exploring-your-data-visually.html#reasons-for-developing-competency-with-data-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are several key reasons we might want to develop competency with data visualization, and before we get started with the <em>how</em> I think it’s worth mentioning these motivating factors.</p>
<div id="to-help-you-explore-your-data" class="section level3 hasAnchor" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> To help you explore your data<a href="exploring-your-data-visually.html#to-help-you-explore-your-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As the Healey quote above implies, one of the main reasons to “look at your data” is to make sure you understand what you’re doing. Looking at your data is a great quick check to make sure that, for example, the linear model (regression or ANOVA) you’re fitting is actually sensible for the data you’ve observed. This is why, for example, examining QQ-plots or residuals is such common practice taught in every statistics class.</p>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>But looking at your data can be even more valuable: our ability to find patterns in visual information is much stronger than our ability to find similar patterns in written information (like tables of data). This can be a disadvantage–we will happily find patterns in truly random data–but it is of great use to us as researchers and scientists. Looking at data is an invaluable way for us to come up with strategies for data analysis, new hypotheses, and even new research questions.</p>
<p>For example, <strong>what patterns can we see in this table of the data we just plotted (a subset, obviously)?</strong></p>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
<th align="right">y1</th>
<th align="right">y2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">-1.3214703</td>
<td align="right">-2.5353760</td>
</tr>
<tr class="even">
<td align="right">0.1010101</td>
<td align="right">-0.8269770</td>
<td align="right">-7.5286794</td>
</tr>
<tr class="odd">
<td align="right">0.2020202</td>
<td align="right">0.4996656</td>
<td align="right">-1.2341072</td>
</tr>
<tr class="even">
<td align="right">0.3030303</td>
<td align="right">0.5917504</td>
<td align="right">5.1983819</td>
</tr>
<tr class="odd">
<td align="right">0.4040404</td>
<td align="right">0.7527332</td>
<td align="right">-2.2728104</td>
</tr>
<tr class="even">
<td align="right">0.5050505</td>
<td align="right">-0.1505266</td>
<td align="right">8.3169781</td>
</tr>
<tr class="odd">
<td align="right">0.6060606</td>
<td align="right">1.1242934</td>
<td align="right">5.6965722</td>
</tr>
<tr class="even">
<td align="right">0.7070707</td>
<td align="right">-1.9397261</td>
<td align="right">7.8641251</td>
</tr>
<tr class="odd">
<td align="right">0.8080808</td>
<td align="right">0.4597118</td>
<td align="right">9.6065223</td>
</tr>
<tr class="even">
<td align="right">0.9090909</td>
<td align="right">0.9153580</td>
<td align="right">0.9753971</td>
</tr>
</tbody>
</table>
<p>When visualizing data <em>for yourself</em>, the goal is to quickly and accurately be able to make plots that you want to see, so that you’re not fiddling with options or struggling to actually see the data. You aren’t looking for “publication quality” visualization–you want to be able to look at your data clearly and quickly.</p>
</div>
<div id="stakeholders" class="section level3 hasAnchor" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> For communication to stakeholders<a href="exploring-your-data-visually.html#stakeholders" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is the main reason we mostly think about doing dataviz: we want to create plots for use in presentations or publications, so that stakeholders–your committee, reveiwers at a journal, peers at a scientific conference–can understand your data quickly and clearly. Below, we can quickly clean up the fake data I made to demonstrate dataviz for yourself to be something we’d be somewhat happier putting into a journal.</p>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>In this case, you care a lot more about the aesthetics. You only get a limited number of plots shown to the audience’s eyes, so you want to be both impactful and attractive. While your readings <span class="citation">(in particular <a href="#ref-healy2019" role="doc-biblioref">Healy 2019</a>)</span> give some advice on this, developing expertise in what is the most effective is a matter of craft–you will see examples as you read papers, and learn what works and doesn’t.</p>
</div>
<div id="for-argumentation" class="section level3 hasAnchor" number="5.1.3">
<h3><span class="header-section-number">5.1.3</span> For argumentation<a href="exploring-your-data-visually.html#for-argumentation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This might more accurately be a subcategory of <a href="exploring-your-data-visually.html#stakeholders">communicating to stakeholders</a>, but often you will want to use your data visualization to effectively make a point. This is where things get a little tricky, and we will be tackling questions of data literacy and ethics a little later in the class, although if you’re interested at all in this topic it may be worth investigating some of the readings in <em>Calling Bullshit</em> <span class="citation">(<a href="#ref-bergstrom2021" role="doc-biblioref">Bergstrom and West 2021</a>)</span> and <em>Data Feminism</em> <span class="citation">(<a href="#ref-dignazio2020" role="doc-biblioref">D’Ignazio and Klein 2020</a>)</span>.</p>
<p>Briefly, we want to make visualizations that, like <a href="exploring-your-data-visually.html#nightingale">Florence Nightingale’s</a>, make our argument effectively–we want the interpretation that others to take away from them to be the interpretation we ourselves have made. But we have to be cautious to not be fooling ourselves and others with bad, misleading, or even unethical choices about how we select our data and visualize it in order to advance our agenda. There are several examples of this given in the references above, as well as a number in <a href="https://socviz.co/lookatdata.html#problems-of-honesty-and-good-judgment">Kieran Healy’s work</a>.</p>
</div>
</div>
<div id="plotting-in-base-r" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Plotting in base R<a href="exploring-your-data-visually.html#plotting-in-base-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>With all that in mind, let’s get into <strong>how to plot data in R</strong>. To explore this, we’re going to use some data from Dr. Sihui Ma’s dissertation research, in which she quantified the amino acid composition of a number of different varieties of apples in Virginia. The abstract for the paper in which these data were published <span class="citation">(<a href="#ref-ma2018a" role="doc-biblioref">Ma et al. 2018</a>)</span> is given here:</p>
<blockquote>
<p>Amino acids and ammonium ions constitute the yeast assimilable nitrogen naturally present in apple juice, with free amino acids being the major constituent. Little information is available on the extent to which free amino acid composition in apple (Malus × domestica Borkh.) juice varies among juices used for fermentation. Twenty amino acids were quantified by UPLC-PDA in juices from 13 apple cultivars grown in Virginia with potential use in cider making. The relative amino acid profile was significantly different among the apple juices evaluated. The total amino acid concentration ranged from 18 mg/L in Blacktwig juice to 57 mg/L in Enterprise juice. l-Asparagine, l-aspartic acid and l-glutamine are the principal amino acids observed in most apple juices. Our results indicate that the relative concentration of amino acids in apples is different from that found in Vitis vinifera wine grapes, which are rich in l-proline and l-arginine. The impact of these differences on fermentation of apple juice by wine yeast strains warrants further research, as the amino acid composition of grape juice impacts wine quality both directly and indirectly via yeast metabolism. These results will inform future research on yeast metabolism and nitrogen management during cider fermentation.</p>
</blockquote>
<p>And here is a sample of what the data look like (without cleaning or wrangling):</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="exploring-your-data-visually.html#cb487-1" aria-hidden="true" tabindex="-1"></a>apples <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Files/Week 5/apple varieties.csv&quot;</span>)</span>
<span id="cb487-2"><a href="exploring-your-data-visually.html#cb487-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(apples) <span class="sc">%&gt;%</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<colgroup>
<col width="13%" />
<col width="4%" />
<col width="3%" />
<col width="4%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="4%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Variety</th>
<th align="left">Rep</th>
<th align="right">His</th>
<th align="right">Asn</th>
<th align="right">Ser</th>
<th align="right">Gln</th>
<th align="right">Arg</th>
<th align="right">Gly</th>
<th align="right">Asp</th>
<th align="right">Glu</th>
<th align="right">Thr</th>
<th align="right">Ala</th>
<th align="right">GABA</th>
<th align="right">Pro</th>
<th align="right">Cys</th>
<th align="right">Lys</th>
<th align="right">Tyr</th>
<th align="right">Met</th>
<th align="right">Val</th>
<th align="right">Ile</th>
<th align="right">Leu</th>
<th align="right">Phe</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Arkansas Black</td>
<td align="left">Rep_1</td>
<td align="right">0.62</td>
<td align="right">10.42</td>
<td align="right">0.68</td>
<td align="right">1.60</td>
<td align="right">0.36</td>
<td align="right">0.09</td>
<td align="right">2.92</td>
<td align="right">2.37</td>
<td align="right">0.20</td>
<td align="right">0.72</td>
<td align="right">0.35</td>
<td align="right">0.26</td>
<td align="right">0.22</td>
<td align="right">0.43</td>
<td align="right">0.67</td>
<td align="right">0.98</td>
<td align="right">0.55</td>
<td align="right">1.59</td>
<td align="right">1.24</td>
<td align="right">3.25</td>
</tr>
<tr class="even">
<td align="left">Blacktwig</td>
<td align="left">Rep_1</td>
<td align="right">0.77</td>
<td align="right">2.32</td>
<td align="right">0.54</td>
<td align="right">0.00</td>
<td align="right">0.24</td>
<td align="right">0.00</td>
<td align="right">1.96</td>
<td align="right">1.03</td>
<td align="right">0.18</td>
<td align="right">0.47</td>
<td align="right">0.15</td>
<td align="right">0.27</td>
<td align="right">0.28</td>
<td align="right">0.52</td>
<td align="right">0.83</td>
<td align="right">1.15</td>
<td align="right">0.62</td>
<td align="right">1.64</td>
<td align="right">1.51</td>
<td align="right">3.70</td>
</tr>
<tr class="odd">
<td align="left">Empire</td>
<td align="left">Rep_1</td>
<td align="right">0.46</td>
<td align="right">21.20</td>
<td align="right">0.43</td>
<td align="right">1.01</td>
<td align="right">0.27</td>
<td align="right">0.09</td>
<td align="right">5.88</td>
<td align="right">1.49</td>
<td align="right">0.28</td>
<td align="right">1.92</td>
<td align="right">0.51</td>
<td align="right">0.67</td>
<td align="right">0.21</td>
<td align="right">0.44</td>
<td align="right">0.65</td>
<td align="right">1.74</td>
<td align="right">0.52</td>
<td align="right">1.50</td>
<td align="right">1.13</td>
<td align="right">3.20</td>
</tr>
<tr class="even">
<td align="left">Enterprise</td>
<td align="left">Rep_1</td>
<td align="right">0.52</td>
<td align="right">34.75</td>
<td align="right">0.90</td>
<td align="right">2.78</td>
<td align="right">0.24</td>
<td align="right">0.08</td>
<td align="right">5.18</td>
<td align="right">2.49</td>
<td align="right">0.33</td>
<td align="right">1.71</td>
<td align="right">0.29</td>
<td align="right">0.37</td>
<td align="right">0.22</td>
<td align="right">0.41</td>
<td align="right">0.66</td>
<td align="right">0.84</td>
<td align="right">0.63</td>
<td align="right">1.39</td>
<td align="right">1.18</td>
<td align="right">2.66</td>
</tr>
<tr class="odd">
<td align="left">Field Red</td>
<td align="left">Rep_1</td>
<td align="right">0.85</td>
<td align="right">4.02</td>
<td align="right">0.29</td>
<td align="right">0.00</td>
<td align="right">0.41</td>
<td align="right">0.00</td>
<td align="right">1.87</td>
<td align="right">1.29</td>
<td align="right">0.19</td>
<td align="right">0.33</td>
<td align="right">0.15</td>
<td align="right">0.00</td>
<td align="right">0.40</td>
<td align="right">0.55</td>
<td align="right">1.03</td>
<td align="right">1.09</td>
<td align="right">1.72</td>
<td align="right">1.82</td>
<td align="right">1.67</td>
<td align="right">13.37</td>
</tr>
<tr class="even">
<td align="left">Golden Delicious</td>
<td align="left">Rep_1</td>
<td align="right">0.56</td>
<td align="right">1.01</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.34</td>
<td align="right">0.00</td>
<td align="right">1.76</td>
<td align="right">0.98</td>
<td align="right">0.32</td>
<td align="right">0.26</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.33</td>
<td align="right">0.49</td>
<td align="right">0.76</td>
<td align="right">0.92</td>
<td align="right">1.50</td>
<td align="right">1.59</td>
<td align="right">1.44</td>
<td align="right">11.83</td>
</tr>
</tbody>
</table>
<p>For reference, the numerical data represent concentrations of amino acids measured as mg/L.</p>
<p>We are going to start with “one-line” plotting commands: simple, base R commands that produce commonly needed data visualizations. We’re going to speed through these in base R and move on to the much more powerful, flexible, and easier (although initially <strong>bewildering</strong>) <code>ggplot2</code>.</p>
<div id="histograms-with-hist" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Histograms with <code id="histograms">hist()</code><a href="exploring-your-data-visually.html#histograms-with-hist" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One of the most common types of data visualizations is a <strong>histogram</strong>. Histograms, briefly, are a common type of data visualization that show the <em>approximate distribution of the data</em>. In plain English, histograms in general try to show how many times a particular range of values are observed in your data. The recipe for making a histogram is as follows:</p>
<ol style="list-style-type: decimal">
<li>Pick the value you want to visualize, call it <span class="math inline">\(x\)</span></li>
<li>Define “bins” of (usually) equal width to count data “in”: for example, if your total range of values that <span class="math inline">\(x\)</span> can take is <span class="math inline">\([1,100]\)</span>, you might define 10 bins as <span class="math inline">\(1-10, 11-20, ..., 91-100\)</span>. Note that this step is something we will almost always let software do for us–we’ll just pick the <em>number</em> of bins we want.</li>
<li>Count the number of times that <span class="math inline">\(x\)</span> is in each bin, and draw a bar graph with that count, with your bins on the x-axis and your counts on the y-axis.</li>
</ol>
<p>Histograms are common because they are a good way to see how our data is distributed. We might be interested to know, for example, whether the data is <em>skewed</em> (whether it is mostly to one or the other side of the histogram) and what counts are most common.</p>
<p>To draw histograms in R, we can use the <code>hist()</code> function. By default, <code>hist()</code> just requires a single <strong>vector</strong> of your data (<span class="math inline">\(x\)</span> in the example above). So, if we are interested in the distribution of alanine concentrations across all of our apple species, we can write the following command:</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="exploring-your-data-visually.html#cb488-1" aria-hidden="true" tabindex="-1"></a>apples <span class="sc">%&gt;%</span> <span class="co"># start with our data</span></span>
<span id="cb488-2"><a href="exploring-your-data-visually.html#cb488-2" aria-hidden="true" tabindex="-1"></a>  .<span class="sc">$</span>Ala <span class="sc">%&gt;%</span> <span class="co"># get the alanine concentrations</span></span>
<span id="cb488-3"><a href="exploring-your-data-visually.html#cb488-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(<span class="at">x =</span> .) <span class="co"># plot the histogram; note that I don&#39;t have to write &quot;x = .&quot; </span></span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>We can see immediately that most apples have very little or no alanine, with a few varieties expressing quite a bit more.</p>
<p>Note that we didn’t define our bins–R picked those for us automatically. But we might prefer to set them differently. In this case, we can use the <code>breaks =</code> argument in the <code>hist()</code> function. Go ahead and use <code>?hist</code> to see what options there are for this. You’ll see there are a few ways to do this, but the easiest is just to give it a single number for the number of breaks we want, and let R figure out the bins.</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="exploring-your-data-visually.html#cb489-1" aria-hidden="true" tabindex="-1"></a>apples <span class="sc">%&gt;%</span> <span class="co"># start with our data</span></span>
<span id="cb489-2"><a href="exploring-your-data-visually.html#cb489-2" aria-hidden="true" tabindex="-1"></a>  .<span class="sc">$</span>Ala <span class="sc">%&gt;%</span> <span class="co"># get the alanine concentrations</span></span>
<span id="cb489-3"><a href="exploring-your-data-visually.html#cb489-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(<span class="at">x =</span> ., <span class="at">breaks =</span> <span class="dv">4</span>) <span class="co"># here we&#39;re reducing the number of breaks, which is probably bad</span></span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Now, it might be nice to see the distribution of concentrations of <em>all</em> amino acids across apples. We will be returning to the subject of <a href="exploring-your-data-visually.html#tidy"><strong>tidy data</strong></a> later today, but for now here’s an easy example:</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="exploring-your-data-visually.html#cb490-1" aria-hidden="true" tabindex="-1"></a>tidy_apples <span class="ot">&lt;-</span> apples <span class="sc">%&gt;%</span></span>
<span id="cb490-2"><a href="exploring-your-data-visually.html#cb490-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">&quot;amino_acid&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;concentration&quot;</span>, <span class="sc">-</span><span class="fu">c</span>(Variety, Rep)) <span class="co"># This makes a single row for each combination of apple, rep, and AA</span></span>
<span id="cb490-3"><a href="exploring-your-data-visually.html#cb490-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-4"><a href="exploring-your-data-visually.html#cb490-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tidy_apples, <span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="co"># head() returns just the first n rows of a data frame so as not to overwhelm the console</span></span>
<span id="cb490-5"><a href="exploring-your-data-visually.html#cb490-5" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Variety</th>
<th align="left">Rep</th>
<th align="left">amino_acid</th>
<th align="right">concentration</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Arkansas Black</td>
<td align="left">Rep_1</td>
<td align="left">His</td>
<td align="right">0.62</td>
</tr>
<tr class="even">
<td align="left">Arkansas Black</td>
<td align="left">Rep_1</td>
<td align="left">Asn</td>
<td align="right">10.42</td>
</tr>
<tr class="odd">
<td align="left">Arkansas Black</td>
<td align="left">Rep_1</td>
<td align="left">Ser</td>
<td align="right">0.68</td>
</tr>
<tr class="even">
<td align="left">Arkansas Black</td>
<td align="left">Rep_1</td>
<td align="left">Gln</td>
<td align="right">1.60</td>
</tr>
<tr class="odd">
<td align="left">Arkansas Black</td>
<td align="left">Rep_1</td>
<td align="left">Arg</td>
<td align="right">0.36</td>
</tr>
<tr class="even">
<td align="left">Arkansas Black</td>
<td align="left">Rep_1</td>
<td align="left">Gly</td>
<td align="right">0.09</td>
</tr>
<tr class="odd">
<td align="left">Arkansas Black</td>
<td align="left">Rep_1</td>
<td align="left">Asp</td>
<td align="right">2.92</td>
</tr>
<tr class="even">
<td align="left">Arkansas Black</td>
<td align="left">Rep_1</td>
<td align="left">Glu</td>
<td align="right">2.37</td>
</tr>
<tr class="odd">
<td align="left">Arkansas Black</td>
<td align="left">Rep_1</td>
<td align="left">Thr</td>
<td align="right">0.20</td>
</tr>
<tr class="even">
<td align="left">Arkansas Black</td>
<td align="left">Rep_1</td>
<td align="left">Ala</td>
<td align="right">0.72</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="exploring-your-data-visually.html#cb491-1" aria-hidden="true" tabindex="-1"></a>tidy_apples <span class="sc">%&gt;%</span> </span>
<span id="cb491-2"><a href="exploring-your-data-visually.html#cb491-2" aria-hidden="true" tabindex="-1"></a>  .<span class="sc">$</span>concentration <span class="sc">%&gt;%</span> <span class="co"># here we select the new &quot;concentration&quot; variable we made</span></span>
<span id="cb491-3"><a href="exploring-your-data-visually.html#cb491-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(<span class="at">breaks =</span> <span class="dv">15</span>)</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Finally, note that the title of our plot is pretty wonky: “Histogram of .”. THis is because the pipe–<code>%&gt;%</code>–doesn’t pass the column name in a way that works for <code>hist()</code>, just the data. For purpose #1 of dataviz, this is fine–we know what we just did. But if we wanted to share this with someone, we might want to give it a better title. We can do that with the <code>main =</code> argument in <code>hist()</code>.</p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="exploring-your-data-visually.html#cb492-1" aria-hidden="true" tabindex="-1"></a>tidy_apples <span class="sc">%&gt;%</span></span>
<span id="cb492-2"><a href="exploring-your-data-visually.html#cb492-2" aria-hidden="true" tabindex="-1"></a>  .<span class="sc">$</span>concentration <span class="sc">%&gt;%</span></span>
<span id="cb492-3"><a href="exploring-your-data-visually.html#cb492-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(<span class="at">breaks =</span> <span class="dv">15</span>, <span class="at">main =</span> <span class="st">&quot;Histogram of amino acids (mg/L) in 13 apple varieties&quot;</span>)</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="boxplots-with-boxplot" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Boxplots with <code>boxplot()</code><a href="exploring-your-data-visually.html#boxplots-with-boxplot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Often, though, we want to know more about our variables than simply the frequency with which they take on certain values. One of the simplest but most effective tools for this task is the <strong>boxplot</strong>, invented by none other than <a href="exploring-your-data-visually.html#tukey">John Tukey</a>. Boxplots concisely communicate much (although not all) of the same information as histograms, but can much more easily accommodate displaying multiple variables at once. It will be helpful to look at some boxplots first while we talk about what they’re displaying:</p>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="exploring-your-data-visually.html#cb493-1" aria-hidden="true" tabindex="-1"></a>tidy_apples <span class="sc">%&gt;%</span></span>
<span id="cb493-2"><a href="exploring-your-data-visually.html#cb493-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">boxplot</span>(concentration <span class="sc">~</span> amino_acid, <span class="at">data =</span> .) <span class="co"># Note that here we have to explicitly write data = ., because data is NOT the first argument</span></span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-9-1.png" width="768" /></p>
<p>Boxplots display a few different statistics (points of information) about the data they describe:</p>
<ol style="list-style-type: decimal">
<li>The median, represented by a center line.</li>
<li>The 25th and 75th <em>percentiles</em> of the data, represented by the upper and lower boxes.</li>
<li>The lower and upper “plausible” bounds of the data, represented by the upper and lower “whiskers” (the lines outside the boxes). In base R, these are defined as <span class="math inline">\(1.5 \cdot IQR\)</span> above or below the upper and lower bounds (respectively), where the <strong>I</strong>nter<strong>q</strong>uartile <strong>R</strong>ange is defined as the difference between the 25th and 75th percentiles, as above.<br />
</li>
<li>Outliers, which are defined as points with values outside the whiskers.</li>
</ol>
<p>Thus, boxplots give a quick picture of how the data are distributed, including information about skewness (the data are skewed if one or the other box and or whisker are much larger). Boxplots also have the advantage that they allow easy comparison: in the figure above we show boxplots for all amino acids measured in the study, <em>across</em> all apple varieties–that is, if we look at alanine, the values being included in the boxplot include all 13 varieties of apple (and their replicates).</p>
<p>We can see from this kind of side-by-side comparison that it appears apples have relatively large amounts of asparagine and phenylalanine, as well as aspartate (unsurprisingly), but lower levels of all other amino acids. We do still see a fair amount of variation, however.</p>
<div id="formulas" class="section level4 hasAnchor" number="5.2.2.1">
<h4><span class="header-section-number">5.2.2.1</span> Formulas!<a href="exploring-your-data-visually.html#formulas" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>You might have noticed that we introduced some new notation into our plot: <code>concentration ~ amino_acid</code>. This is an example of an R <code>formula</code> object. You can learn more by reading the help page at <code>?formula</code>, but it’s honestly kind of abstruse. Essentially, we can read <code>~</code> in R as meaning “depends on” or “is related to”. Formulas are <strong>always directional</strong>–we talk about the left-hand side (LHS) and right-hand side (RHS). Formulas get used a lot in R statistical modeling, and we’ll also see them pop up all over the place, such as in the function <code>xtable()</code> (for plotting contingency tables). Right now, you just need to read them as specified above: <code>concentration ~ amino_acid</code> is saying that the <code>concentration</code> (LHS) is dependent on the specific <code>amino_acid</code> (RHS), wich is a categorical variable telling us which amino acid is which.</p>
<p>This also implies we might use boxplots to explore (slice?) the data in different ways. For example, we could ask <em>“Is there apparent variation in total amino acid content by apple variety?”</em></p>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="exploring-your-data-visually.html#cb494-1" aria-hidden="true" tabindex="-1"></a>tidy_apples <span class="sc">%&gt;%</span></span>
<span id="cb494-2"><a href="exploring-your-data-visually.html#cb494-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">boxplot</span>(concentration <span class="sc">~</span> Variety, <span class="at">data =</span> .) <span class="co"># note the new formula: concentration ~ Variety</span></span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-10-1.png" width="768" /></p>
<p>While there are a large number of outliers here, it seems like on a first glance that the total amino acid content per apple isn’t all that different. We might still want to investigate specific amino acid distributions for each type of apple:</p>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="exploring-your-data-visually.html#cb495-1" aria-hidden="true" tabindex="-1"></a>tidy_apples <span class="sc">%&gt;%</span></span>
<span id="cb495-2"><a href="exploring-your-data-visually.html#cb495-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(amino_acid <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Asp&quot;</span>, <span class="st">&quot;Asn&quot;</span>, <span class="st">&quot;Phe&quot;</span>)) <span class="sc">%&gt;%</span> <span class="co"># let&#39;s look at the most abundant AAs</span></span>
<span id="cb495-3"><a href="exploring-your-data-visually.html#cb495-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">boxplot</span>(concentration <span class="sc">~</span> Variety, <span class="at">data =</span> .)</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-11-1.png" width="768" /></p>
<p>This starts to look like we might be seeing more variation. But boxplots may not be the best tool to drill deeply into this.</p>
<p>As a closing note, we can always set options for title, axis labels, etc just as we did with <code>hist()</code>:</p>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="exploring-your-data-visually.html#cb496-1" aria-hidden="true" tabindex="-1"></a>tidy_apples <span class="sc">%&gt;%</span></span>
<span id="cb496-2"><a href="exploring-your-data-visually.html#cb496-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(amino_acid <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Gln&quot;</span>, <span class="st">&quot;Gly&quot;</span>, <span class="st">&quot;Pro&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb496-3"><a href="exploring-your-data-visually.html#cb496-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">boxplot</span>(concentration <span class="sc">~</span> Variety, </span>
<span id="cb496-4"><a href="exploring-your-data-visually.html#cb496-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> ., </span>
<span id="cb496-5"><a href="exploring-your-data-visually.html#cb496-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">&quot;Concentration of glycine, glutamine, and proline in 13 apple varieties&quot;</span>,</span>
<span id="cb496-6"><a href="exploring-your-data-visually.html#cb496-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">&quot;Apple variety&quot;</span>,</span>
<span id="cb496-7"><a href="exploring-your-data-visually.html#cb496-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">&quot;Concentration (mg/L) of glycine, glutamine, or proline&quot;</span>)</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-12-1.png" width="768" /></p>
</div>
</div>
<div id="generic-plot" class="section level3 hasAnchor" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Generic <code>plot()</code><a href="exploring-your-data-visually.html#generic-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Both <code>hist()</code> and <code>boxplot()</code> are functional shortcuts for the generic R <code>plot()</code> method. In a very general sense, <code>plot()</code> initializes a graphical output and then accepts new objects to put into it. <code>hist()</code>, for example, has a bunch of default options designed to draw columns, set the range on the x- and y-axes correctly, etc.</p>
<p>We can use <code>plot()</code> directly in two ways. The most common is that you’ll call it directly on the results of some other function or analysis. For example, if we might run an ANOVA on our apple data in order to ask if, for phenylalanine, concentrations are dependent on apple variety:</p>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="exploring-your-data-visually.html#cb497-1" aria-hidden="true" tabindex="-1"></a>tidy_apples <span class="sc">%&gt;%</span></span>
<span id="cb497-2"><a href="exploring-your-data-visually.html#cb497-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(amino_acid <span class="sc">==</span> <span class="st">&quot;Phe&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb497-3"><a href="exploring-your-data-visually.html#cb497-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aov</span>(concentration <span class="sc">~</span> Variety, <span class="at">data =</span> .) <span class="sc">%&gt;%</span></span>
<span id="cb497-4"><a href="exploring-your-data-visually.html#cb497-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>() <span class="sc">%&gt;%</span></span>
<span id="cb497-5"><a href="exploring-your-data-visually.html#cb497-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>…this doesn’t get us what we want, <em>at all</em>, but it does get us a plot! In fact, what it’s trying to do here is to plot every variable against every other variable in what is known commonly as “pair-plot”. But you can see that here we just let R decide on the plot it wants to make with the object we give it.</p>
<p>While this may occasionally be what you want to do, generally we will use <code>plot()</code> to systematically build up a plot.</p>
<p>For example, let’s say we want to see if there’s some kind of relationship between aspartate and asparagine:</p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="exploring-your-data-visually.html#cb498-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> apples<span class="sc">$</span>Asn, <span class="at">y =</span> apples<span class="sc">$</span>Asp) <span class="co"># Note that here we can&#39;t use the %&gt;% easily, because we need &quot;x = &quot; AND &quot;y = &quot;.</span></span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>This is pretty bare bones, but it looks like there is a relationship. Maybe we think it would be prettier if we added lines connecting each (x, y) pair to the next one in order to see if there’s a trend:</p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="exploring-your-data-visually.html#cb499-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> apples<span class="sc">$</span>Asn, <span class="at">y =</span> apples<span class="sc">$</span>Asp, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>) <span class="co"># &quot;b&quot; = BOTH a line and the points</span></span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Yikes! That looks terrible! Unfortunately, that’s kind of common for any kind of computer program, because our first rule here applies: this is powerful and fast, but also does exactly what we ask, <em>not what we want</em>. In this particular case, that’s because our pairs aren’t ordered:</p>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="exploring-your-data-visually.html#cb500-1" aria-hidden="true" tabindex="-1"></a>apples <span class="sc">%&gt;%</span></span>
<span id="cb500-2"><a href="exploring-your-data-visually.html#cb500-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Variety, Asn, Asp) <span class="sc">%&gt;%</span></span>
<span id="cb500-3"><a href="exploring-your-data-visually.html#cb500-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb500-4"><a href="exploring-your-data-visually.html#cb500-4" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Variety</th>
<th align="right">Asn</th>
<th align="right">Asp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Arkansas Black</td>
<td align="right">10.42</td>
<td align="right">2.92</td>
</tr>
<tr class="even">
<td align="left">Blacktwig</td>
<td align="right">2.32</td>
<td align="right">1.96</td>
</tr>
<tr class="odd">
<td align="left">Empire</td>
<td align="right">21.20</td>
<td align="right">5.88</td>
</tr>
<tr class="even">
<td align="left">Enterprise</td>
<td align="right">34.75</td>
<td align="right">5.18</td>
</tr>
<tr class="odd">
<td align="left">Field Red</td>
<td align="right">4.02</td>
<td align="right">1.87</td>
</tr>
<tr class="even">
<td align="left">Golden Delicious</td>
<td align="right">1.01</td>
<td align="right">1.76</td>
</tr>
<tr class="odd">
<td align="left">Granny Smith</td>
<td align="right">8.76</td>
<td align="right">1.41</td>
</tr>
<tr class="even">
<td align="left">Newtown Pippin</td>
<td align="right">26.13</td>
<td align="right">5.14</td>
</tr>
<tr class="odd">
<td align="left">Northern Spy</td>
<td align="right">2.52</td>
<td align="right">1.60</td>
</tr>
<tr class="even">
<td align="left">Rome</td>
<td align="right">1.57</td>
<td align="right">1.23</td>
</tr>
</tbody>
</table>
<p>If we really want that kind of plot (perhaps our lines are meant to show the trend clearly?) we need to order our points into the order we expect them to show up on the plot:</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="exploring-your-data-visually.html#cb501-1" aria-hidden="true" tabindex="-1"></a>apples <span class="sc">%&gt;%</span></span>
<span id="cb501-2"><a href="exploring-your-data-visually.html#cb501-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Variety, Asn, Asp) <span class="sc">%&gt;%</span></span>
<span id="cb501-3"><a href="exploring-your-data-visually.html#cb501-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Asn, Asp) <span class="sc">%&gt;%</span> <span class="co"># we can sort our data by Asn, then by Asp</span></span>
<span id="cb501-4"><a href="exploring-your-data-visually.html#cb501-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(., <span class="fu">plot</span>(<span class="at">x =</span> Asn, <span class="at">y =</span> Asp, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>)) <span class="co"># the with() function creates a new environment and lets us use %&gt;% here</span></span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>Just as with <code>hist()</code> and <code>boxplot()</code>, we can also easily change titles and axis labels for clarity:</p>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="exploring-your-data-visually.html#cb502-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> apples<span class="sc">$</span>Asn, <span class="at">y =</span> apples<span class="sc">$</span>Asp, </span>
<span id="cb502-2"><a href="exploring-your-data-visually.html#cb502-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Relationship of Asn and Asp in 13 apple varieties&quot;</span>,</span>
<span id="cb502-3"><a href="exploring-your-data-visually.html#cb502-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Asparagine (mg/L)&quot;</span>,</span>
<span id="cb502-4"><a href="exploring-your-data-visually.html#cb502-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Aspartate (mg/L)&quot;</span>)</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div id="adding-points" class="section level4 hasAnchor" number="5.2.3.1">
<h4><span class="header-section-number">5.2.3.1</span> Adding <code>points()</code><a href="exploring-your-data-visually.html#adding-points" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>But beyond just changing labels, we can do a lot of construction on our generic visualizations from <code>plot()</code>. R uses an <strong>additive</strong> approach to plotting. Once we have a plot, we have the option of adding the <code>add = TRUE</code> argument to any plotting functions to (attempt to) plot our new elements right onto the previous plot. We might want to do this to:</p>
<ul>
<li>Add some new data to the plot (like points we hadn’t plotted before)</li>
<li>Add a fitted model (like a curve representing a regression) to the plot</li>
<li>Add some annotations to the plot</li>
</ul>
<p>We will go over the first two use cases here, but because we’re going to be emphasizing tidy plotting using <code>ggplot2</code> for most of the class, we won’t be concentrating on every possible way to implement plot options in base R–there are just too many! But know that you can do many things that are very powerful in R plotting, even without learning <code>ggplot2</code> (which is easier, anyway).</p>
<p>Now, imagine we wanted to plot the relationship between asparagine and aspartate <strong>and</strong> phenylalanine. The <code>plot()</code> function only accepts one <code>x =</code> and one <code>y =</code> argument, so how can you plot both? Assuming we want to use asparagine as our x variable, and plot it against aspartate and against phenylalanine, we might take an approach like the following</p>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="exploring-your-data-visually.html#cb503-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> apples<span class="sc">$</span>Asn, <span class="at">y =</span> apples<span class="sc">$</span>Asp, <span class="at">xlab =</span> <span class="st">&quot;Asparagine (mg/L)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Concentration (mg/L)&quot;</span>) <span class="co"># make our previous plot</span></span>
<span id="cb503-2"><a href="exploring-your-data-visually.html#cb503-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> apples<span class="sc">$</span>Asn, <span class="at">y =</span> apples<span class="sc">$</span>Phe, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>) <span class="co"># add points with y-values from the phenylalanine concentrations</span></span>
<span id="cb503-3"><a href="exploring-your-data-visually.html#cb503-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;aspartate&quot;</span>, <span class="st">&quot;phenylalanine&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">pch =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>Now, I will be the first to agree that this isn’t a particularly pretty or useful plot, but it <em>did</em> do what we asked. We can see that the relationship between phenylalanine concetration and asparagine concentration seems much weaker than between asparagine and aspartate (which makes sense).</p>
<p>You might also be noting the <code>legend()</code> function here–this is one base R way of adding annotation to a plot. While the syntax is pretty arcane, I think it will illustrate some of the ways that R thinks if I describe what’s happening:</p>
<ul>
<li><code>x</code> is a placeholder for a text string to say where to put the legend</li>
<li>The <code>legend =</code> argument asks what <em>entries</em> you want in the legend</li>
<li><code>col =</code> lets you set the color of each legend entry, in the same order they are in <code>legend =</code></li>
<li><code>pch =</code> lets you set the shape of your legend entries, in the same order they are in <code>legend =</code>. Because we didn’t make different shapes in this plot, both are shape “1”, which is equivalent to the open circle.</li>
</ul>
<p>You can learn more about the shapes and colors (and other attributes, like size) that you can set for points in R by looking at <code>?points</code>.</p>
</div>
<div id="adding-lines-with-abline" class="section level4 hasAnchor" number="5.2.3.2">
<h4><span class="header-section-number">5.2.3.2</span> Adding lines with <code>abline()</code><a href="exploring-your-data-visually.html#adding-lines-with-abline" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s continue with this example. We want to know whether there is a relationship between asparagine concentration and both aspartate and phenylalanine. It appears there is some kind of relationship between asparagine and aspartate: higher values of asparagine concentration generally are associated with higher values of aspartate. The same does not appear to be true for phenylalanine.</p>
<p>As you know from stats class, this is a classic linear regression question. We’ll learn more about this in later classes, but the way we run linear regression in R is using the <code>lm()</code> function. We are going to ask for simple linear regressions describing our research question, and then plot the resulting regression lines onto our plot–we are going to <strong>add lines to this plot</strong>.</p>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="exploring-your-data-visually.html#cb504-1" aria-hidden="true" tabindex="-1"></a>asp_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Asp <span class="sc">~</span> Asn, <span class="at">data =</span> apples) <span class="co"># we will save our model.  Note the formula syntax again!</span></span>
<span id="cb504-2"><a href="exploring-your-data-visually.html#cb504-2" aria-hidden="true" tabindex="-1"></a>phe_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Phe <span class="sc">~</span> Asn, <span class="at">data =</span> apples) <span class="co"># What is different about this line?</span></span>
<span id="cb504-3"><a href="exploring-your-data-visually.html#cb504-3" aria-hidden="true" tabindex="-1"></a>asp_model</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Asp ~ Asn, data = apples)
## 
## Coefficients:
## (Intercept)          Asn  
##      1.6214       0.1289</code></pre>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="exploring-your-data-visually.html#cb506-1" aria-hidden="true" tabindex="-1"></a>phe_model</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Phe ~ Asn, data = apples)
## 
## Coefficients:
## (Intercept)          Asn  
##      9.3494      -0.2581</code></pre>
<p>These models are complex R objects (what happens if you use <code>typeof()</code>, <code>str()</code>, and <code>class()</code> on <code>asp_model</code>?), but their default print value is to give you the coefficients of the regression model you’ve fitted. For example, the linear model fit is <span class="math inline">\(\hat{Asp} = 0.1288706 \cdot Asn + 1.6213577\)</span>. We can directly access these using the <code>coefficients()</code> function, if we want to, and also get some more info using the <code>summary()</code> function.</p>
<p>But we are most interested in plotting! The <code>abline()</code> function adds a line to any plot in the <span class="math inline">\(y = a + b \cdot x\)</span> format common to algebra, and because R is built around statistics it turns out that <code>abline()</code> can directly plot linear models.</p>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="exploring-your-data-visually.html#cb508-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First we will recreate our previous plot</span></span>
<span id="cb508-2"><a href="exploring-your-data-visually.html#cb508-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> apples<span class="sc">$</span>Asn, <span class="at">y =</span> apples<span class="sc">$</span>Asp, <span class="at">xlab =</span> <span class="st">&quot;Asparagine (mg/L)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Concentration (mg/L)&quot;</span>) <span class="co"># make our previous plot</span></span>
<span id="cb508-3"><a href="exploring-your-data-visually.html#cb508-3" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> apples<span class="sc">$</span>Asn, <span class="at">y =</span> apples<span class="sc">$</span>Phe, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>) <span class="co"># add points with y-values from the phenylalanine concentrations</span></span>
<span id="cb508-4"><a href="exploring-your-data-visually.html#cb508-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;aspartate&quot;</span>, <span class="st">&quot;phenylalanine&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">pch =</span> <span class="dv">1</span>)</span>
<span id="cb508-5"><a href="exploring-your-data-visually.html#cb508-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb508-6"><a href="exploring-your-data-visually.html#cb508-6" aria-hidden="true" tabindex="-1"></a><span class="co"># And now we can use abline() to add our two model fits</span></span>
<span id="cb508-7"><a href="exploring-your-data-visually.html#cb508-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(asp_model, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>) <span class="co"># make sure the color matches the points!</span></span>
<span id="cb508-8"><a href="exploring-your-data-visually.html#cb508-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(phe_model, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Oh no! That looks terrible for two reasons.</p>
<ol style="list-style-type: decimal">
<li>The phenylalanine fit goes over the legend. This tells us something about <em>how</em> R is building these plots: it puts each layer on top of the previous ones. So, we can reorganize the order in which we add elements by calling <code>legend()</code> <em>last</em> in order to fix this.</li>
<li>The phenylalanine fit doesn’t look like it fits our plot very well, does it? But in fact, it does! This is a lesson, once again, in <strong>how R does what you <em>ask</em>, not what you want</strong>.</li>
</ol>
<p>What happened? Well, the we never actually looked at just a plot of <code>phenylalanine ~ asparagine</code> (in R formula syntax):</p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="exploring-your-data-visually.html#cb509-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(apples, <span class="fu">plot</span>(<span class="at">x =</span> Asn, <span class="at">y =</span> Phe, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)) <span class="co"># I am using the with() syntax as a demonstration again</span></span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>When we look at <em>this</em> plot it is clear that a cluster of points was <em>outside of the range</em> of our original plot. This is because, in base R, <code>plot()</code> draws a “canvas” or “area” based on the original data–all subsequent additions are fit into (or chopped out of) this plot. So R happily made us a plot of <code>aspartate ~ asparagine</code> and then, when we asked to add phenylalanine, it just didn’t put in the points outside that area! Here’s what happens if we reverse the whole sequence:</p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="exploring-your-data-visually.html#cb510-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> apples<span class="sc">$</span>Asn, <span class="at">y =</span> apples<span class="sc">$</span>Phe, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Asparagine (mg/L)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Concentration (mg/L)&quot;</span>)</span>
<span id="cb510-2"><a href="exploring-your-data-visually.html#cb510-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> apples<span class="sc">$</span>Asn, <span class="at">y =</span> apples<span class="sc">$</span>Asp, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb510-3"><a href="exploring-your-data-visually.html#cb510-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(asp_model, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb510-4"><a href="exploring-your-data-visually.html#cb510-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(phe_model, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb510-5"><a href="exploring-your-data-visually.html#cb510-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;aspartate&quot;</span>, <span class="st">&quot;phenylalanine&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">pch =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>Now we see the whole story. Of course, part of that story is that a linear fit is probably not sensible for this particular model, but now we at least can see why these fits are being produced.</p>
<p>In many ways this workflow is a good demonstration of the use of dataviz in order to explore your own data. Step by step we encountered unexpected things and used our tools in R to understand where they came from. Of course, at the same time we learned about how to render plots in R.</p>
</div>
</div>
<div id="saving-plots-to-file" class="section level3 hasAnchor" number="5.2.4">
<h3><span class="header-section-number">5.2.4</span> Saving plots to file<a href="exploring-your-data-visually.html#saving-plots-to-file" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Once you have a plot in R you might want to know how to save it. Of course, in R Markdown the plot gets rendered into your knitted file, but how can you save the file to disk, perhaps to use in a presentation or a paper?</p>
<p>One way that <strong>you should NOT do this</strong> is by using the RStudio Export menu in the Plot pane:</p>
<div class="figure">
<img src="Images/Week%205/Rstudio%20image%20export.png" alt="" />
<p class="caption">RStudio image export interface.</p>
</div>
<p>For whatever reason, this is one of the weakest utilities built into RStudio. It rarely outputs in high enough resolution for modern usage, and gives you very little control over size and aspect ratio. <strong>Don’t use it.</strong></p>
<p>Instead, unfortunately, you will have to use R’s somewhat arcane (to non-programmers) <strong>graphic device interface</strong>. By default, RStudio outputs to the Plot Pane as the “graphic device”. Instead, if you want to write an image to disk, you need to tell it to use a new graphic device by telling R to do so explicitly, using one of the device commands: <code>jpeg()</code>, <code>png()</code>, and less commonly <code>tiff()</code> or <code>bmp()</code>. Generally you will want to use the PNG format for modern software.</p>
<p>To do so, you follow the following recipe:</p>
<ol style="list-style-type: decimal">
<li>Create a new graphic device by calling one of the functions (like <code>jpeg()</code>) with the appropriate options. This makes an <em>empty</em> image file on your disk.</li>
<li>Run the plotting functions you normally want to run.</li>
<li>Use the function <code>dev.off()</code> to close the graphic device, stop editing the image file, and revert to plotting in R.</li>
</ol>
<p>So, for example, the following code will write our plot to a PNG with the name “asn_vs_asp_and_phe.png”.</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="exploring-your-data-visually.html#cb511-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Open a new graphic device</span></span>
<span id="cb511-2"><a href="exploring-your-data-visually.html#cb511-2" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">filename =</span> <span class="st">&quot;asn_vs_asp_and_phe.png&quot;</span>, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">units =</span> <span class="st">&quot;in&quot;</span>, <span class="at">res =</span> <span class="dv">300</span>)</span>
<span id="cb511-3"><a href="exploring-your-data-visually.html#cb511-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb511-4"><a href="exploring-your-data-visually.html#cb511-4" aria-hidden="true" tabindex="-1"></a><span class="co"># All of this code is just our plot from before</span></span>
<span id="cb511-5"><a href="exploring-your-data-visually.html#cb511-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> apples<span class="sc">$</span>Asn, <span class="at">y =</span> apples<span class="sc">$</span>Phe, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Asparagine (mg/L)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Concentration (mg/L)&quot;</span>)</span>
<span id="cb511-6"><a href="exploring-your-data-visually.html#cb511-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> apples<span class="sc">$</span>Asn, <span class="at">y =</span> apples<span class="sc">$</span>Asp, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb511-7"><a href="exploring-your-data-visually.html#cb511-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(asp_model, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb511-8"><a href="exploring-your-data-visually.html#cb511-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(phe_model, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb511-9"><a href="exploring-your-data-visually.html#cb511-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;aspartate&quot;</span>, <span class="st">&quot;phenylalanine&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">pch =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb511-10"><a href="exploring-your-data-visually.html#cb511-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb511-11"><a href="exploring-your-data-visually.html#cb511-11" aria-hidden="true" tabindex="-1"></a><span class="co"># And this code turns off that connection and returns us to the RStudio Plot Pane</span></span>
<span id="cb511-12"><a href="exploring-your-data-visually.html#cb511-12" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<pre><code>## quartz_off_screen 
##                 2</code></pre>
<p>You’ll see that, unlike our previous code chunks, this one doesn’t print anything in the Markdown. That’s because it has instead redirected the plotting output to the file we specified. If we forgot to run <code>dev.off()</code>, we’d end up continuing to send out plotting output to that same file–definitely not something we want to do!</p>
<p>While that seems like a lot of work, in general once you understand the steps it becomes somewhat natural. All of the arguments for <code>png()</code> have to do with the size and resolution of the plot–you can learn about them by reading <code>?png</code>.</p>
</div>
</div>
<div id="the-grammar-of-graphics-ggplot2" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> The ‘grammar of graphics’: <code>ggplot2</code><a href="exploring-your-data-visually.html#the-grammar-of-graphics-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We’ve now learned a bit about how base R treats plotting, although we’ve really only scratched the surface. By using <code>plot()</code> on many different outputs from different R modeling functions (like <code>lm()</code>, etc), you will be able to automatically make many default plots. But as you can see the default, while very customizable, is also somewhat arcane and difficult to use. it also doesn’t have great default settings–you’ll notice that our plots, while clear, are not particularly compelling looking.</p>
<p>This is where <code>ggplot2</code> comes in. The name for this package, which is part of the <code>tidyverse</code>, comes from the “<strong>G</strong>rammar of <strong>G</strong>raphics”, a conceptual framework for theorizing the elements of a visualization. These are explained in some detail in <a href="https://r4ds.had.co.nz/data-visualisation.html">Chapter 3</a> and <a href="https://r4ds.had.co.nz/graphics-for-communication.html">Chapter 24</a> of <em>R for Data Science</em> <span class="citation">(<a href="#ref-wickham2017" role="doc-biblioref">Wickham and Grolemund 2017</a>)</span>, and <a href="https://socviz.co/">Kieran Healy’s book</a> <span class="citation">(<a href="#ref-healy2019" role="doc-biblioref">Healy 2019</a>)</span>, while not going into the theory, gives a detailed explanation.</p>
<p>In my typical, vague and hand-wave-y fashion, here is my summary of the innovation that <code>ggplot2</code> encodes and makes accessible to the average R user:</p>
<ol style="list-style-type: decimal">
<li>We can break down the elements of a data visualization systematically.
<ol style="list-style-type: decimal">
<li><em>Mappings</em>, which connect data to visual elements, like coordinates on a graph, colors, or other <em>aesthetic</em> elements of a plot</li>
<li><em>Geoms</em>, which dictate how to take the mapped elements and render them into visual elements, such as a boxplot, points, or lines</li>
<li>Visual aspects of the plot which are unrelated to data, such as the overall theme, background color, font choice, etc</li>
</ol></li>
<li>Treating data visualizations as cousins to data frames or tibbles lets us easily manipulate them without having to restart them from scratch when we make mistakes or discover new ways we want to treat the plot or data.</li>
<li>Breaking apart these elements allows us to swap parts in and out without redoing all our previous work, for example we could change the x-axis scale without changing anything else, or change the color of our points or our title.</li>
</ol>
<div id="anatomy-of-a-ggplot" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Anatomy of a <code>ggplot()</code><a href="exploring-your-data-visually.html#anatomy-of-a-ggplot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To use <code>ggplot2</code>, you’ll have to load the package, which you have already done if you ran <code>library(tidyverse)</code> at the start of this R Markdown.</p>
<p>The basic command structure looks more complicated than the <code>plot()</code> functions we’ve been using so far:</p>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="exploring-your-data-visually.html#cb513-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The ggplot() function creates your plotting environment.  We usually save it to a variable in R so that we can use the plug-n-play functionality of ggplot without retyping a bunch of nonsense</span></span>
<span id="cb513-2"><a href="exploring-your-data-visually.html#cb513-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">&lt;</span>a variable<span class="sc">&gt;</span>, <span class="at">y =</span> <span class="sc">&lt;</span>another variable<span class="sc">&gt;</span>, ...),</span>
<span id="cb513-3"><a href="exploring-your-data-visually.html#cb513-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> <span class="sc">&lt;</span>your data<span class="sc">&gt;</span>)</span>
<span id="cb513-4"><a href="exploring-your-data-visually.html#cb513-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb513-5"><a href="exploring-your-data-visually.html#cb513-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Then, you can add various ways of plotting data to make different visualizations.</span></span>
<span id="cb513-6"><a href="exploring-your-data-visually.html#cb513-6" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> </span>
<span id="cb513-7"><a href="exploring-your-data-visually.html#cb513-7" aria-hidden="true" tabindex="-1"></a>  geom_<span class="sc">&lt;</span>your chosen way of plotting<span class="sc">&gt;</span>(...) <span class="sc">+</span></span>
<span id="cb513-8"><a href="exploring-your-data-visually.html#cb513-8" aria-hidden="true" tabindex="-1"></a>  theme_<span class="sc">&lt;</span>your chosen theme<span class="sc">&gt;</span> <span class="sc">+</span></span>
<span id="cb513-9"><a href="exploring-your-data-visually.html#cb513-9" aria-hidden="true" tabindex="-1"></a>  ...</span></code></pre></div>
<p>In graphical form, the following diagram (<a href="https://vt-hydroinformatics.github.io/Plotting.html#our-first-ggplot">from VT Professor JP Gannon</a>) gives an intuition of what is happening:</p>
<div class="figure">
<img src="Images/Week%205/GGplot%20syntax.png" alt="" />
<p class="caption">Basic ggplot mappings. Color boxes indicate where the elements go in the function and in the plot.</p>
</div>
<p>To use <code>ggplot()</code>, your <code>data</code> will usually have to be in “tidy” format: that is, long rather than wide. We’ve already talked about Wickham’s <span class="citation">(<a href="#ref-wickham2017" role="doc-biblioref">2017</a>)</span> <a href="https://r4ds.had.co.nz/tidy-data.html">definition</a>, and Kieran Healy <span class="citation">(<a href="#ref-healy2019" role="doc-biblioref">2019</a>)</span> takes <a href="https://socviz.co/makeplot.html#tidy-data">another crack at it here</a>.</p>
<p>In our example, the original <code>apples</code> data frame is not tidy:</p>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="exploring-your-data-visually.html#cb514-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(apples) <span class="sc">%&gt;%</span></span>
<span id="cb514-2"><a href="exploring-your-data-visually.html#cb514-2" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<colgroup>
<col width="13%" />
<col width="4%" />
<col width="3%" />
<col width="4%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="4%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Variety</th>
<th align="left">Rep</th>
<th align="right">His</th>
<th align="right">Asn</th>
<th align="right">Ser</th>
<th align="right">Gln</th>
<th align="right">Arg</th>
<th align="right">Gly</th>
<th align="right">Asp</th>
<th align="right">Glu</th>
<th align="right">Thr</th>
<th align="right">Ala</th>
<th align="right">GABA</th>
<th align="right">Pro</th>
<th align="right">Cys</th>
<th align="right">Lys</th>
<th align="right">Tyr</th>
<th align="right">Met</th>
<th align="right">Val</th>
<th align="right">Ile</th>
<th align="right">Leu</th>
<th align="right">Phe</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Arkansas Black</td>
<td align="left">Rep_1</td>
<td align="right">0.62</td>
<td align="right">10.42</td>
<td align="right">0.68</td>
<td align="right">1.60</td>
<td align="right">0.36</td>
<td align="right">0.09</td>
<td align="right">2.92</td>
<td align="right">2.37</td>
<td align="right">0.20</td>
<td align="right">0.72</td>
<td align="right">0.35</td>
<td align="right">0.26</td>
<td align="right">0.22</td>
<td align="right">0.43</td>
<td align="right">0.67</td>
<td align="right">0.98</td>
<td align="right">0.55</td>
<td align="right">1.59</td>
<td align="right">1.24</td>
<td align="right">3.25</td>
</tr>
<tr class="even">
<td align="left">Blacktwig</td>
<td align="left">Rep_1</td>
<td align="right">0.77</td>
<td align="right">2.32</td>
<td align="right">0.54</td>
<td align="right">0.00</td>
<td align="right">0.24</td>
<td align="right">0.00</td>
<td align="right">1.96</td>
<td align="right">1.03</td>
<td align="right">0.18</td>
<td align="right">0.47</td>
<td align="right">0.15</td>
<td align="right">0.27</td>
<td align="right">0.28</td>
<td align="right">0.52</td>
<td align="right">0.83</td>
<td align="right">1.15</td>
<td align="right">0.62</td>
<td align="right">1.64</td>
<td align="right">1.51</td>
<td align="right">3.70</td>
</tr>
<tr class="odd">
<td align="left">Empire</td>
<td align="left">Rep_1</td>
<td align="right">0.46</td>
<td align="right">21.20</td>
<td align="right">0.43</td>
<td align="right">1.01</td>
<td align="right">0.27</td>
<td align="right">0.09</td>
<td align="right">5.88</td>
<td align="right">1.49</td>
<td align="right">0.28</td>
<td align="right">1.92</td>
<td align="right">0.51</td>
<td align="right">0.67</td>
<td align="right">0.21</td>
<td align="right">0.44</td>
<td align="right">0.65</td>
<td align="right">1.74</td>
<td align="right">0.52</td>
<td align="right">1.50</td>
<td align="right">1.13</td>
<td align="right">3.20</td>
</tr>
<tr class="even">
<td align="left">Enterprise</td>
<td align="left">Rep_1</td>
<td align="right">0.52</td>
<td align="right">34.75</td>
<td align="right">0.90</td>
<td align="right">2.78</td>
<td align="right">0.24</td>
<td align="right">0.08</td>
<td align="right">5.18</td>
<td align="right">2.49</td>
<td align="right">0.33</td>
<td align="right">1.71</td>
<td align="right">0.29</td>
<td align="right">0.37</td>
<td align="right">0.22</td>
<td align="right">0.41</td>
<td align="right">0.66</td>
<td align="right">0.84</td>
<td align="right">0.63</td>
<td align="right">1.39</td>
<td align="right">1.18</td>
<td align="right">2.66</td>
</tr>
<tr class="odd">
<td align="left">Field Red</td>
<td align="left">Rep_1</td>
<td align="right">0.85</td>
<td align="right">4.02</td>
<td align="right">0.29</td>
<td align="right">0.00</td>
<td align="right">0.41</td>
<td align="right">0.00</td>
<td align="right">1.87</td>
<td align="right">1.29</td>
<td align="right">0.19</td>
<td align="right">0.33</td>
<td align="right">0.15</td>
<td align="right">0.00</td>
<td align="right">0.40</td>
<td align="right">0.55</td>
<td align="right">1.03</td>
<td align="right">1.09</td>
<td align="right">1.72</td>
<td align="right">1.82</td>
<td align="right">1.67</td>
<td align="right">13.37</td>
</tr>
<tr class="even">
<td align="left">Golden Delicious</td>
<td align="left">Rep_1</td>
<td align="right">0.56</td>
<td align="right">1.01</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.34</td>
<td align="right">0.00</td>
<td align="right">1.76</td>
<td align="right">0.98</td>
<td align="right">0.32</td>
<td align="right">0.26</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.33</td>
<td align="right">0.49</td>
<td align="right">0.76</td>
<td align="right">0.92</td>
<td align="right">1.50</td>
<td align="right">1.59</td>
<td align="right">1.44</td>
<td align="right">11.83</td>
</tr>
</tbody>
</table>
<p>Each row contains data about 1 apple variety in 1 analytical rep, but there are multiple amino acid observations in each row–we can say that the columns are an unrecorded variable–<code>amino_acid</code>–which is spread “wide” across those columns. In contrast, our <code>tidy_apples</code> dataset has only one observation per row:</p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="exploring-your-data-visually.html#cb515-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tidy_apples) <span class="sc">%&gt;%</span></span>
<span id="cb515-2"><a href="exploring-your-data-visually.html#cb515-2" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Variety</th>
<th align="left">Rep</th>
<th align="left">amino_acid</th>
<th align="right">concentration</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Arkansas Black</td>
<td align="left">Rep_1</td>
<td align="left">His</td>
<td align="right">0.62</td>
</tr>
<tr class="even">
<td align="left">Arkansas Black</td>
<td align="left">Rep_1</td>
<td align="left">Asn</td>
<td align="right">10.42</td>
</tr>
<tr class="odd">
<td align="left">Arkansas Black</td>
<td align="left">Rep_1</td>
<td align="left">Ser</td>
<td align="right">0.68</td>
</tr>
<tr class="even">
<td align="left">Arkansas Black</td>
<td align="left">Rep_1</td>
<td align="left">Gln</td>
<td align="right">1.60</td>
</tr>
<tr class="odd">
<td align="left">Arkansas Black</td>
<td align="left">Rep_1</td>
<td align="left">Arg</td>
<td align="right">0.36</td>
</tr>
<tr class="even">
<td align="left">Arkansas Black</td>
<td align="left">Rep_1</td>
<td align="left">Gly</td>
<td align="right">0.09</td>
</tr>
</tbody>
</table>
<p>For example, in row 3 of this dataset, we have a single observation: the concentration of <code>amino_acid = Ser</code> for <code>Rep = 1</code> of <code>Variety = Arkansas Black</code> is 0.68 mg/L. This kind of data is easier to do operations like filtering, selecting, and otherwise manipulating, and, as we’ll see, it is easier to plot, especially ing <code>ggplot2</code>. However, this doesn’t mean wide data is “bad” or “wrong”–it is often much more convenient for humans to read and for a number of multivariate analyses. We’ll <a href="exploring-your-data-visually.html#tidy">see below</a> how we can easily go between wide/long data using <code>pivot_*()</code> functions, which will let us get data easily into the formats we want.</p>
<p>To return to our example, let’s take a look at recreating our <a href="exploring-your-data-visually.html#histograms">histogram of all apple varieties and all amino acids</a>.</p>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="exploring-your-data-visually.html#cb516-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First we can create a ggplot() object that stores what variable we want to plot through the &quot;mapping&quot; of an aesthetic function</span></span>
<span id="cb516-2"><a href="exploring-your-data-visually.html#cb516-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> tidy_apples <span class="sc">%&gt;%</span></span>
<span id="cb516-3"><a href="exploring-your-data-visually.html#cb516-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> ., <span class="co"># the &quot;data = .&quot; argument is written out for clarity</span></span>
<span id="cb516-4"><a href="exploring-your-data-visually.html#cb516-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> concentration)) </span>
<span id="cb516-5"><a href="exploring-your-data-visually.html#cb516-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb516-6"><a href="exploring-your-data-visually.html#cb516-6" aria-hidden="true" tabindex="-1"></a><span class="co"># If we try to plot p, we will see only the blank canvas because we haven&#39;t defined any geoms</span></span>
<span id="cb516-7"><a href="exploring-your-data-visually.html#cb516-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p)</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="exploring-your-data-visually.html#cb517-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Then we add elements to the plot</span></span>
<span id="cb517-2"><a href="exploring-your-data-visually.html#cb517-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p <span class="sc">+</span> </span>
<span id="cb517-3"><a href="exploring-your-data-visually.html#cb517-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb517-4"><a href="exploring-your-data-visually.html#cb517-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="co"># This changes the theme to a nicer, &quot;R style&quot; plot</span></span>
<span id="cb517-5"><a href="exploring-your-data-visually.html#cb517-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Amino acid concentration (mg/L)&quot;</span>) <span class="co"># This relabels the x-axis with a more descriptive label</span></span>
<span id="cb517-6"><a href="exploring-your-data-visually.html#cb517-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb517-7"><a href="exploring-your-data-visually.html#cb517-7" aria-hidden="true" tabindex="-1"></a><span class="co"># We can actually plot ggplots by just calling them directly</span></span>
<span id="cb517-8"><a href="exploring-your-data-visually.html#cb517-8" aria-hidden="true" tabindex="-1"></a>p2</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-28-2.png" width="672" /></p>
<p>While that doesn’t seem so impressive compared to the ease of a one-stop function like <code>hist()</code>, you should be able to start to see how we can add and subtract elements to change our plots around, as well as being able to save them and print them again and again at will. This lets us do several things:</p>
<ol style="list-style-type: decimal">
<li>We can build up plots step-by-step in order to make sure we’ve got everything right, avoiding mistakes like our scale problem in our scatterplot above.</li>
<li>We can do complex things like, for example, breaking out our plots by some kind of grouping variable (“faceting”):</li>
</ol>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="exploring-your-data-visually.html#cb518-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span> </span>
<span id="cb518-2"><a href="exploring-your-data-visually.html#cb518-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>amino_acid)</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>Now <em>that’s</em> pretty cool. It also points to the importance of tidy data for this kind of plotting–we are able to essentially tell <code>ggplot()</code> “pull out all the data that is tagged with distinct values of <code>amino_acid</code> in that column and plot them individually.”</p>
<div id="what-the-heck-is-doing" class="section level4 hasAnchor" number="5.3.1.1">
<h4><span class="header-section-number">5.3.1.1</span> WHAT THE HECK IS <code>+</code> doing ???<a href="exploring-your-data-visually.html#what-the-heck-is-doing" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Ok, let’s start unpicking this. The first thing you have probably noticed about <code>ggplot()</code> is the way that you build the plots: by using <code>+</code> to <em>literally</em> add new elements or themes or other things to the plot. This is contrary to both everything in base R (there we just ran plotting functions sequentially) and <code>tidyverse</code> conventions (which generally use the <code>%&gt;%</code> to do something similar).</p>
<p>The short story is that, in fact, it would be better if <code>ggplot2</code> used <code>%&gt;%</code>, and someday it will. But it is older than the rest of the tidyverse, and so was programmed using both different syntax and slightly different underlying functional programming, so it doesn’t work with <code>%&gt;%</code>.</p>
<p>I personally think it’s easiest to think of <code>+</code> in <code>ggplot2</code> as literal. When you see it, read it as “and then add <code>&lt;this element&gt;</code>…”, rather than “pass what’s on the left hand side to the right hand side”. So it works a lot like the pipe, but is not interchangeable.</p>
</div>
<div id="the-aes-functionargument" class="section level4 hasAnchor" number="5.3.1.2">
<h4><span class="header-section-number">5.3.1.2</span> The <code>aes()</code> function/argument<a href="exploring-your-data-visually.html#the-aes-functionargument" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>ggplot()</code> function takes two arguments that are essential, as well as some others you’ll rarely use. The first, <code>data =</code>, is straightforward, and you’ll usually be passing data to the function at the end of some pipeline using <code>%&gt;%</code></p>
<p>The second, <code>mapping =</code>, is less clear. This argument requires the <code>aes()</code> function, which can be read as the “aesthetic” function. The way that this function works is quite complex, and really not worth digging into here, but I understand it in my head as <strong>telling <code>ggplot()</code> what part of my data is going to connect to what part of the plot</strong>. So, if we write <code>aes(x = concentration)</code>, we can read this in our heads as “the values of x will be mapped from the ‘concentration’ column”.</p>
<p>This sentence tells us the other important thing about <code>ggplot()</code> and the <code>aes()</code> mappings: <strong>mapped variables each have to be in their own column</strong>. This is another reason that <code>ggplot()</code> requires tidy data. Let’s look again at the original apples data:</p>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="exploring-your-data-visually.html#cb519-1" aria-hidden="true" tabindex="-1"></a>apples <span class="sc">%&gt;%</span></span>
<span id="cb519-2"><a href="exploring-your-data-visually.html#cb519-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb519-3"><a href="exploring-your-data-visually.html#cb519-3" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<colgroup>
<col width="13%" />
<col width="4%" />
<col width="3%" />
<col width="4%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="4%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Variety</th>
<th align="left">Rep</th>
<th align="right">His</th>
<th align="right">Asn</th>
<th align="right">Ser</th>
<th align="right">Gln</th>
<th align="right">Arg</th>
<th align="right">Gly</th>
<th align="right">Asp</th>
<th align="right">Glu</th>
<th align="right">Thr</th>
<th align="right">Ala</th>
<th align="right">GABA</th>
<th align="right">Pro</th>
<th align="right">Cys</th>
<th align="right">Lys</th>
<th align="right">Tyr</th>
<th align="right">Met</th>
<th align="right">Val</th>
<th align="right">Ile</th>
<th align="right">Leu</th>
<th align="right">Phe</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Arkansas Black</td>
<td align="left">Rep_1</td>
<td align="right">0.62</td>
<td align="right">10.42</td>
<td align="right">0.68</td>
<td align="right">1.60</td>
<td align="right">0.36</td>
<td align="right">0.09</td>
<td align="right">2.92</td>
<td align="right">2.37</td>
<td align="right">0.20</td>
<td align="right">0.72</td>
<td align="right">0.35</td>
<td align="right">0.26</td>
<td align="right">0.22</td>
<td align="right">0.43</td>
<td align="right">0.67</td>
<td align="right">0.98</td>
<td align="right">0.55</td>
<td align="right">1.59</td>
<td align="right">1.24</td>
<td align="right">3.25</td>
</tr>
<tr class="even">
<td align="left">Blacktwig</td>
<td align="left">Rep_1</td>
<td align="right">0.77</td>
<td align="right">2.32</td>
<td align="right">0.54</td>
<td align="right">0.00</td>
<td align="right">0.24</td>
<td align="right">0.00</td>
<td align="right">1.96</td>
<td align="right">1.03</td>
<td align="right">0.18</td>
<td align="right">0.47</td>
<td align="right">0.15</td>
<td align="right">0.27</td>
<td align="right">0.28</td>
<td align="right">0.52</td>
<td align="right">0.83</td>
<td align="right">1.15</td>
<td align="right">0.62</td>
<td align="right">1.64</td>
<td align="right">1.51</td>
<td align="right">3.70</td>
</tr>
<tr class="odd">
<td align="left">Empire</td>
<td align="left">Rep_1</td>
<td align="right">0.46</td>
<td align="right">21.20</td>
<td align="right">0.43</td>
<td align="right">1.01</td>
<td align="right">0.27</td>
<td align="right">0.09</td>
<td align="right">5.88</td>
<td align="right">1.49</td>
<td align="right">0.28</td>
<td align="right">1.92</td>
<td align="right">0.51</td>
<td align="right">0.67</td>
<td align="right">0.21</td>
<td align="right">0.44</td>
<td align="right">0.65</td>
<td align="right">1.74</td>
<td align="right">0.52</td>
<td align="right">1.50</td>
<td align="right">1.13</td>
<td align="right">3.20</td>
</tr>
<tr class="even">
<td align="left">Enterprise</td>
<td align="left">Rep_1</td>
<td align="right">0.52</td>
<td align="right">34.75</td>
<td align="right">0.90</td>
<td align="right">2.78</td>
<td align="right">0.24</td>
<td align="right">0.08</td>
<td align="right">5.18</td>
<td align="right">2.49</td>
<td align="right">0.33</td>
<td align="right">1.71</td>
<td align="right">0.29</td>
<td align="right">0.37</td>
<td align="right">0.22</td>
<td align="right">0.41</td>
<td align="right">0.66</td>
<td align="right">0.84</td>
<td align="right">0.63</td>
<td align="right">1.39</td>
<td align="right">1.18</td>
<td align="right">2.66</td>
</tr>
<tr class="odd">
<td align="left">Field Red</td>
<td align="left">Rep_1</td>
<td align="right">0.85</td>
<td align="right">4.02</td>
<td align="right">0.29</td>
<td align="right">0.00</td>
<td align="right">0.41</td>
<td align="right">0.00</td>
<td align="right">1.87</td>
<td align="right">1.29</td>
<td align="right">0.19</td>
<td align="right">0.33</td>
<td align="right">0.15</td>
<td align="right">0.00</td>
<td align="right">0.40</td>
<td align="right">0.55</td>
<td align="right">1.03</td>
<td align="right">1.09</td>
<td align="right">1.72</td>
<td align="right">1.82</td>
<td align="right">1.67</td>
<td align="right">13.37</td>
</tr>
<tr class="even">
<td align="left">Golden Delicious</td>
<td align="left">Rep_1</td>
<td align="right">0.56</td>
<td align="right">1.01</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.34</td>
<td align="right">0.00</td>
<td align="right">1.76</td>
<td align="right">0.98</td>
<td align="right">0.32</td>
<td align="right">0.26</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.33</td>
<td align="right">0.49</td>
<td align="right">0.76</td>
<td align="right">0.92</td>
<td align="right">1.50</td>
<td align="right">1.59</td>
<td align="right">1.44</td>
<td align="right">11.83</td>
</tr>
<tr class="odd">
<td align="left">Granny Smith</td>
<td align="left">Rep_1</td>
<td align="right">0.61</td>
<td align="right">8.76</td>
<td align="right">0.34</td>
<td align="right">0.00</td>
<td align="right">0.31</td>
<td align="right">0.10</td>
<td align="right">1.41</td>
<td align="right">0.58</td>
<td align="right">0.38</td>
<td align="right">0.42</td>
<td align="right">0.00</td>
<td align="right">0.23</td>
<td align="right">0.37</td>
<td align="right">0.56</td>
<td align="right">1.49</td>
<td align="right">1.28</td>
<td align="right">1.66</td>
<td align="right">2.00</td>
<td align="right">1.62</td>
<td align="right">3.79</td>
</tr>
<tr class="even">
<td align="left">Newtown Pippin</td>
<td align="left">Rep_1</td>
<td align="right">0.33</td>
<td align="right">26.13</td>
<td align="right">1.01</td>
<td align="right">1.36</td>
<td align="right">0.67</td>
<td align="right">0.13</td>
<td align="right">5.14</td>
<td align="right">3.23</td>
<td align="right">0.57</td>
<td align="right">1.03</td>
<td align="right">0.54</td>
<td align="right">0.28</td>
<td align="right">0.36</td>
<td align="right">0.60</td>
<td align="right">0.94</td>
<td align="right">1.38</td>
<td align="right">0.85</td>
<td align="right">2.12</td>
<td align="right">1.39</td>
<td align="right">4.50</td>
</tr>
<tr class="odd">
<td align="left">Northern Spy</td>
<td align="left">Rep_1</td>
<td align="right">0.51</td>
<td align="right">2.52</td>
<td align="right">0.17</td>
<td align="right">0.00</td>
<td align="right">0.23</td>
<td align="right">0.00</td>
<td align="right">1.60</td>
<td align="right">1.05</td>
<td align="right">0.35</td>
<td align="right">0.34</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.35</td>
<td align="right">0.53</td>
<td align="right">1.24</td>
<td align="right">1.34</td>
<td align="right">1.52</td>
<td align="right">2.04</td>
<td align="right">1.25</td>
<td align="right">12.47</td>
</tr>
<tr class="even">
<td align="left">Rome</td>
<td align="left">Rep_1</td>
<td align="right">0.36</td>
<td align="right">1.57</td>
<td align="right">0.20</td>
<td align="right">0.00</td>
<td align="right">0.43</td>
<td align="right">0.08</td>
<td align="right">1.23</td>
<td align="right">0.91</td>
<td align="right">0.34</td>
<td align="right">0.23</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.33</td>
<td align="right">0.54</td>
<td align="right">0.80</td>
<td align="right">1.02</td>
<td align="right">1.63</td>
<td align="right">1.92</td>
<td align="right">1.46</td>
<td align="right">12.68</td>
</tr>
</tbody>
</table>
<p>Here we have a data frame that is cleaned and well organized, but it is <strong>wide</strong>. The variable that is used for <strong>faceting</strong> above to make the previous plot–the name of the amino acid being measured in each column–is spread out over the column names, and so <code>ggplot()</code> can’t easily find it in order to make this nice kind of faceted plot. It <em>is</em> possible to do this kind of faceting in base R (with or without tidy data) using control-flow and the <code>par()</code> function–I leave it to you as an exercise to try it, as a way to develop programming skills.</p>
<p>In our example, we used <code>aes()</code> to map the <code>x = concentration</code> in the original call to <code>ggplot()</code>, and then added elements to that original, blank canvas. You’ll note, in particular, that we <em>didn’t</em> tell <code>geom_histogram()</code> that the x-values it was counting were coming from conentration. This is one of the key rules of <code>ggplot()</code>: <strong>each additional element of a plot <em>inherits</em> the mappings of the plot from the base function</strong>.</p>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="exploring-your-data-visually.html#cb520-1" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> p <span class="sc">+</span> </span>
<span id="cb520-2"><a href="exploring-your-data-visually.html#cb520-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Variety), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb520-3"><a href="exploring-your-data-visually.html#cb520-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb520-4"><a href="exploring-your-data-visually.html#cb520-4" aria-hidden="true" tabindex="-1"></a>p3</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<p>So, in this plot, we’ve colored each column in the same histogram as before with the number of counts that come from different types of apples. This isn’t super useful as a visualization, but it does demonstrate the principle: <code>geom_histogram()</code> inherited the aesthetic mapping of <code>x = concentration</code> from the previous statement (<code>ggplot()</code>). We <em>didn’t have to set it</em>.</p>
<p>It <em>also</em> demonstrates a second principle: each subsequent addition to a plot can add new aesthetics. In our case, <em>within</em> <code>geom_histogram()</code> we set <code>mapping = aes(fill = Variety)</code>, which told <code>ggplot()</code> to (automatically) assign a different color to each unique value of <code>Variety</code> (why is it “<code>fill</code>” and not “<code>color</code>”?). You’ll also note that <code>ggplot()</code> then <em>automatically</em> made a legend for us in the plot, showing us the choices it had made.</p>
</div>
<div id="settings-outside-of-aes" class="section level4 hasAnchor" number="5.3.1.3">
<h4><span class="header-section-number">5.3.1.3</span> Settings outside of <code>aes()</code><a href="exploring-your-data-visually.html#settings-outside-of-aes" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>You may also have noticed in the previous plot that we <em>did</em> also set a <code>color =</code> argument in the <code>geom_histogram()</code> function–but <em>outside</em> the whole <code>mapping = aes(&lt;stuff&gt;)</code> argument. This is what we might call a “set” variable, as opposed to a “mapped” variable (which are all <em>within</em> <code>aes()</code>). We wrote <code>color = "black"</code>, which tells <code>ggplot()</code> and specifically the <code>geom_histogram()</code> part of <code>ggplot()</code> to <strong>not</strong> look for a variable to map to color, but just to set it to <code>"black"</code>. This is a shortcut to one of the colors that R knows about–you can get a full list of these by running <code>colors()</code>.</p>
<p>In general, in <code>ggplot()</code> if we want the data visualization to programmatically assign some aesthetic aspect of the plot from a variable in our data, we will want to <strong>map</strong> that aesthetic using the <code>mapping = aes()</code> argument construction, either in <code>ggplot()</code> or in one of the subsequent layer functions. If we want to set an aesthetic aspect to be constant, we <strong>set</strong> it in the function argument outside of <code>aes()</code> to be a constant.</p>
<p>Based on this principle, what is going wrong in this plot? This is one of the most common problems in <code>ggplot()</code>.</p>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="exploring-your-data-visually.html#cb521-1" aria-hidden="true" tabindex="-1"></a>tidy_apples <span class="sc">%&gt;%</span></span>
<span id="cb521-2"><a href="exploring-your-data-visually.html#cb521-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> concentration, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb521-3"><a href="exploring-your-data-visually.html#cb521-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb521-4"><a href="exploring-your-data-visually.html#cb521-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
</div>
<div id="themes-with-theme_" class="section level4 hasAnchor" number="5.3.1.4">
<h4><span class="header-section-number">5.3.1.4</span> Themes with <code>theme_*()</code><a href="exploring-your-data-visually.html#themes-with-theme_" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>I’ve ended all of my plots using <code>ggplot()</code> with the addition of <code>theme_classic()</code>. In <code>ggplot()</code>, <strong>themes</strong> encompass everything about the plot that doesn’t depend on data at all. Things like the way the legend is printed, whether or not there is a coordinate grid displayed on the plot, the background color, etc–these are all related to themes. <code>ggplot2</code> comes with a bunch of shortcut themes that you can apply, like <code>theme_classic()</code>, <code>theme_minimal()</code>, <code>theme_bw()</code>, etc.</p>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="exploring-your-data-visually.html#cb522-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span> </span>
<span id="cb522-2"><a href="exploring-your-data-visually.html#cb522-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dark</span>()</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<p>If you need to manipulate individual aspects of a plot, you may need to use the general <code>theme()</code> function. This allows you to very precisely manipulate aspects of the theme, but it is not very user friendly. This is one of the points where a developed sense of “how do I search Stack Exchange for this?” will be your friend!</p>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="exploring-your-data-visually.html#cb523-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span> </span>
<span id="cb523-2"><a href="exploring-your-data-visually.html#cb523-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>),</span>
<span id="cb523-3"><a href="exploring-your-data-visually.html#cb523-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
</div>
<div id="all-these-damn-scale_-functions" class="section level4 hasAnchor" number="5.3.1.5">
<h4><span class="header-section-number">5.3.1.5</span> All these damn <code>scale_*()</code> functions<a href="exploring-your-data-visually.html#all-these-damn-scale_-functions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Finally, say we didn’t like the default color set for the filled bars in our histogram. How can we manipulate the colors that are plotted? The <strong>way in which</strong> mapped, aesthetic variables are assigned to visual elements is controlled by the <code>scale_*()</code> functions. In my experience, the most frequently encountered scales are those for color: either <code>scale_fill_*()</code> for solid objects (like the bars in a histogram) or <code>scale_color_*()</code> for lines and points (like the outlines of the histogram bars).</p>
<p>Scale functions work by telling <code>ggplot()</code> <em>how</em> to map aesthetic variables to visual elements. So, in the case of our histogram, we have mapped different values of <code>Variety</code> to different fill colors, but we haven’t actually told <code>ggplot()</code> <em>which</em> colors we want. We can do this with <code>scale_fill_*()</code>.</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="exploring-your-data-visually.html#cb524-1" aria-hidden="true" tabindex="-1"></a>p3 <span class="sc">+</span> </span>
<span id="cb524-2"><a href="exploring-your-data-visually.html#cb524-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="co"># this is just one option - use tab-completion to see some others</span></span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<p><code>ggplot2</code> has a broad range of built-in options for scales, but there are many others available in add-on packages that build on top of it. You can also build your own scales using the <code>scale_*_manual()</code> functions, in which you give a vector of the same length as your mapped aesthetic variable in order to set up the visual assignment. That sounds jargon-y, so here is an example:</p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="exploring-your-data-visually.html#cb525-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We&#39;ll pick 14 random colors from the colors R knows about</span></span>
<span id="cb525-2"><a href="exploring-your-data-visually.html#cb525-2" aria-hidden="true" tabindex="-1"></a>random_colors <span class="ot">&lt;-</span> <span class="fu">print</span>(<span class="fu">colors</span>()[<span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">colors</span>()), <span class="at">size =</span> <span class="dv">14</span>)])</span></code></pre></div>
<pre><code>##  [1] &quot;palegoldenrod&quot; &quot;deepskyblue2&quot;  &quot;purple1&quot;       &quot;goldenrod1&quot;   
##  [5] &quot;orchid1&quot;       &quot;chocolate&quot;     &quot;seagreen2&quot;     &quot;mediumpurple&quot; 
##  [9] &quot;sienna&quot;        &quot;orchid2&quot;       &quot;mediumorchid1&quot; &quot;steelblue3&quot;   
## [13] &quot;olivedrab2&quot;    &quot;lightsalmon3&quot;</code></pre>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="exploring-your-data-visually.html#cb527-1" aria-hidden="true" tabindex="-1"></a>p3 <span class="sc">+</span> </span>
<span id="cb527-2"><a href="exploring-your-data-visually.html#cb527-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> random_colors)</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<p>Obviously this doesn’t produce <em>good</em> results, but it illustrates how you can use this function to set colors the way you’d like.</p>
</div>
<div id="faceting-making-multiple-plots" class="section level4 hasAnchor" number="5.3.1.6">
<h4><span class="header-section-number">5.3.1.6</span> Faceting (making multiple plots)<a href="exploring-your-data-visually.html#faceting-making-multiple-plots" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The final bit of recipe we’ve seen so far is the <code>facet_wrap()</code> function, which–still almost magically, to me–splits our plot into multiple <strong>facets</strong> according to the specified variable(s). The classic interface for this uses R expressions–the <code>~</code> notation–but there are now other options, which are detailed if we inspect the <code>?facet_wrap</code> documentation.</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="exploring-your-data-visually.html#cb528-1" aria-hidden="true" tabindex="-1"></a>p3 <span class="sc">+</span></span>
<span id="cb528-2"><a href="exploring-your-data-visually.html#cb528-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Rep)</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p>The only difference is that we must write a “one-sided” function: leave the left-hand side (LHS) of the expression empty.</p>
<p>We can actually facet by multiple variables. Remember that every combination of variables will make one facet in the array of plots, so you want to be cautious or all of your plots will be illegible. That’s why I am going to filter our data and show this off with just a few apple varieties:</p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="exploring-your-data-visually.html#cb529-1" aria-hidden="true" tabindex="-1"></a>tidy_apples <span class="sc">%&gt;%</span></span>
<span id="cb529-2"><a href="exploring-your-data-visually.html#cb529-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Variety <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Arkansas Black&quot;</span>, <span class="st">&quot;Granny Smith&quot;</span>, <span class="st">&quot;Northern Spy&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb529-3"><a href="exploring-your-data-visually.html#cb529-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> concentration)) <span class="sc">+</span></span>
<span id="cb529-4"><a href="exploring-your-data-visually.html#cb529-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Variety), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb529-5"><a href="exploring-your-data-visually.html#cb529-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Variety <span class="sc">+</span> Rep) <span class="sc">+</span> </span>
<span id="cb529-6"><a href="exploring-your-data-visually.html#cb529-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<p>We can also set up the arrangement of the grid by manipulating the <code>nrow =</code> and <code>ncol =</code> arguments, just like when we make a <code>matrix()</code>.</p>
<p>There is a companion function for <code>facet_wrap()</code> named <code>facet_grid()</code>. Test out your ability to read help files to figure out what the difference between the two are.</p>
</div>
</div>
<div id="common-recipes-for-basic-tasks" class="section level3 hasAnchor" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Common recipes for basic tasks<a href="exploring-your-data-visually.html#common-recipes-for-basic-tasks" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that we have the start of a grasp on how <code>ggplot2</code> works, let’s look at a few of the common visualizations that you’d want to use for your own data exploration or for publication–the main tasks of dataviz.</p>
<div id="histograms-with-geom_histogramgeom_density" class="section level4 hasAnchor" number="5.3.2.1">
<h4><span class="header-section-number">5.3.2.1</span> Histograms with <code>geom_histogram()</code>/<code>geom_density()</code><a href="exploring-your-data-visually.html#histograms-with-geom_histogramgeom_density" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We’ve already thoroughly explored how to make histograms from our apple data with <code>geom_histogram()</code>. A related option that gives a little more information, especially for large, continuous dataset is called a <em>density plot</em>. These visualize an <em>empirical probability density</em> based on your dataset. For our apples, let’s look at the density plot instead of the histogram:</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="exploring-your-data-visually.html#cb530-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> </span>
<span id="cb530-2"><a href="exploring-your-data-visually.html#cb530-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span> </span>
<span id="cb530-3"><a href="exploring-your-data-visually.html#cb530-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>If you squint, you can see the plotted line describes a similar shape to our histogram. We can use <code>ggplot()</code>s layering ability to just put them both on the same plot:</p>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="exploring-your-data-visually.html#cb531-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> </span>
<span id="cb531-2"><a href="exploring-your-data-visually.html#cb531-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(count <span class="sc">/</span> <span class="fu">sum</span>(count))), <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb531-3"><a href="exploring-your-data-visually.html#cb531-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb531-4"><a href="exploring-your-data-visually.html#cb531-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<p>FYI, a similar approach can be achieved with <code>geom_freqpoly()</code>, which literally draws a line between the peak of each bar in a histogram:</p>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="exploring-your-data-visually.html#cb532-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> </span>
<span id="cb532-2"><a href="exploring-your-data-visually.html#cb532-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb532-3"><a href="exploring-your-data-visually.html#cb532-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_freqpoly</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb532-4"><a href="exploring-your-data-visually.html#cb532-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<p>These are not exact duplicates because <em>density</em> is based on a smoothed estimate, whereas both <em>histogram</em> and <em>freqpoly</em> are just empirical counts.</p>
</div>
<div id="boxplots-with-geom_boxplot-geom_violin" class="section level4 hasAnchor" number="5.3.2.2">
<h4><span class="header-section-number">5.3.2.2</span> Boxplots with <code>geom_boxplot()</code> / <code>geom_violin()</code><a href="exploring-your-data-visually.html#boxplots-with-geom_boxplot-geom_violin" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>I agree with John Tukey that boxplots are some of the best visualizations for quickly understanding the distribution of different categorical variables. <code>ggplot()</code> does a great job with boxplots, especially when combined with facets. As you might imagine, <code>geom_boxplot()</code> will give you boxplots.</p>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="exploring-your-data-visually.html#cb533-1" aria-hidden="true" tabindex="-1"></a>tidy_apples <span class="sc">%&gt;%</span></span>
<span id="cb533-2"><a href="exploring-your-data-visually.html#cb533-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> amino_acid, <span class="at">y =</span> concentration)) <span class="sc">+</span></span>
<span id="cb533-3"><a href="exploring-your-data-visually.html#cb533-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb533-4"><a href="exploring-your-data-visually.html#cb533-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p>Notice that, unlike in our examples with histogram, in <code>ggplot()</code> we now need to map <em>both</em> <code>x</code> and <code>y</code> aesthetic variables. In English, you might say “we are interested in the values of concentration (y) at each type of amino acid (x).”</p>
<p>A related visualization is the “violin” plot–instead of a straight box, violin plots show the distribution of observations around the IQR:</p>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="exploring-your-data-visually.html#cb534-1" aria-hidden="true" tabindex="-1"></a>tidy_apples <span class="sc">%&gt;%</span></span>
<span id="cb534-2"><a href="exploring-your-data-visually.html#cb534-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Rep, <span class="at">y =</span> concentration)) <span class="sc">+</span> </span>
<span id="cb534-3"><a href="exploring-your-data-visually.html#cb534-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb534-4"><a href="exploring-your-data-visually.html#cb534-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>Because our data doesn’t have a lot of variation in most of the categories of <code>amino_acid</code>, I demonstrated this plot using the <code>Rep</code> variable, which unsurprisingly (and reassuringly) doesn’t look much different across the 3 reps.</p>
</div>
<div id="scatterplots-with-geom_point" class="section level4 hasAnchor" number="5.3.2.3">
<h4><span class="header-section-number">5.3.2.3</span> Scatterplots with <code>geom_point()</code><a href="exploring-your-data-visually.html#scatterplots-with-geom_point" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We haven’t really talked about types of data explicitly in this class from a <strong>measurement theory</strong> perspective. Who can tell me the definition of these four types of data:</p>
<ol style="list-style-type: decimal">
<li>Nominal</li>
<li>Ordinal</li>
<li>Interval</li>
<li>Ratio</li>
</ol>
<p>For our purposes in R, we can largely think about these two categories instead:</p>
<ol style="list-style-type: decimal">
<li>Categorical</li>
<li>Continuous</li>
</ol>
<p>How do these relate?</p>
<p>So far, in all of our <code>ggplot()</code> examples, we’ve been plotting either a single continuous variable (<code>concentration</code>), or one continuous variable against a categorical variable (e.g., <code>concentration ~ Variety</code>). But in our base plotting we were using the most common kind of continuous vs. continuous plot: a <strong>scatterplot</strong>.</p>
<p>Scatterplots are the visualizations that we’re all most comfortable with: basic Cartesian (x, y) plots. In <code>ggplot2</code>, we use <code>geom_point()</code> to make scatter plots. Let’s recreate our base R scatterplot:</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="exploring-your-data-visually.html#cb535-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that here I am using apples instead of tidy_apples - why?</span></span>
<span id="cb535-2"><a href="exploring-your-data-visually.html#cb535-2" aria-hidden="true" tabindex="-1"></a>apples <span class="sc">%&gt;%</span></span>
<span id="cb535-3"><a href="exploring-your-data-visually.html#cb535-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Asn, <span class="at">y =</span> Asp)) <span class="sc">+</span> </span>
<span id="cb535-4"><a href="exploring-your-data-visually.html#cb535-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb535-5"><a href="exploring-your-data-visually.html#cb535-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<p>One advantage of <code>ggplot()</code> visualization is that it takes care of scaling for us. If we want to add the phenylalanine points, <code>ggplot()</code> is smart enough to resize the plot to include the cluster of points we previously missed.</p>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="exploring-your-data-visually.html#cb536-1" aria-hidden="true" tabindex="-1"></a>apples <span class="sc">%&gt;%</span></span>
<span id="cb536-2"><a href="exploring-your-data-visually.html#cb536-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Asn, <span class="at">y =</span> Asp)) <span class="sc">+</span> </span>
<span id="cb536-3"><a href="exploring-your-data-visually.html#cb536-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb536-4"><a href="exploring-your-data-visually.html#cb536-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Phe), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="co"># note that this still INHERITS the x = Asn mapping</span></span>
<span id="cb536-5"><a href="exploring-your-data-visually.html#cb536-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<p>However, note that <code>ggplot()</code> isn’t magic. Confusingly, our y-axis is now labeled “Asp”, even though it is really plotting “Concentration” of both Asp (black) and Phe (red).</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="exploring-your-data-visually.html#cb537-1" aria-hidden="true" tabindex="-1"></a>apples <span class="sc">%&gt;%</span></span>
<span id="cb537-2"><a href="exploring-your-data-visually.html#cb537-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Asn, <span class="at">y =</span> Asp)) <span class="sc">+</span> </span>
<span id="cb537-3"><a href="exploring-your-data-visually.html#cb537-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span>  </span>
<span id="cb537-4"><a href="exploring-your-data-visually.html#cb537-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Phe), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb537-5"><a href="exploring-your-data-visually.html#cb537-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb537-6"><a href="exploring-your-data-visually.html#cb537-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Asparagine (mg/L)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Concentration (mg/L)&quot;</span>)</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<p>But you’ll notice there still isn’t a legend. It turns out that is because we’re using <code>ggplot()</code> in a nonstandard way. As homework, I will be asking you to find a way to create a similar kind of plot but to do it using tidy data, which will produce a legend properly.</p>
<div id="correlation-fit-plots-with-geom_smooth" class="section level5 hasAnchor" number="5.3.2.3.1">
<h5><span class="header-section-number">5.3.2.3.1</span> Correlation fit plots with <code>geom_smooth()</code><a href="exploring-your-data-visually.html#correlation-fit-plots-with-geom_smooth" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>To continue recreating our previous example, we might want to add linear fits to these two sets of points. The function that fits a model to points in <code>ggplot2</code> is called <code>geom_smooth()</code>–it adds a “smoothed” model fit.</p>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="exploring-your-data-visually.html#cb538-1" aria-hidden="true" tabindex="-1"></a>apples <span class="sc">%&gt;%</span></span>
<span id="cb538-2"><a href="exploring-your-data-visually.html#cb538-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Asn, <span class="at">y =</span> Asp)) <span class="sc">+</span> </span>
<span id="cb538-3"><a href="exploring-your-data-visually.html#cb538-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span>  </span>
<span id="cb538-4"><a href="exploring-your-data-visually.html#cb538-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Phe), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb538-5"><a href="exploring-your-data-visually.html#cb538-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span> </span>
<span id="cb538-6"><a href="exploring-your-data-visually.html#cb538-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">y =</span> Phe), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span></span>
<span id="cb538-7"><a href="exploring-your-data-visually.html#cb538-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb538-8"><a href="exploring-your-data-visually.html#cb538-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Asparagine (mg/L)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Concentration (mg/L)&quot;</span>)</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<p>Notice that we had to add two calls to <code>geom_smooth()</code>–one that inherited our initial mapping of <code>y = Asp</code>, and one that overrides that to be <code>y = Phe</code>, just as we do for the <code>geom_point()</code> calls. The <code>method = "lm"</code> argument tells <code>geom_smooth()</code> to use the <code>lm()</code> function, just like we did with our base R <code>abline()</code> call. This is not the default for <code>geom_smooth()</code>–it has built in math to try to choose the best model. Let’s see what it does if we let it choose it’s own fit:</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="exploring-your-data-visually.html#cb539-1" aria-hidden="true" tabindex="-1"></a>apples <span class="sc">%&gt;%</span></span>
<span id="cb539-2"><a href="exploring-your-data-visually.html#cb539-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Asn, <span class="at">y =</span> Asp)) <span class="sc">+</span> </span>
<span id="cb539-3"><a href="exploring-your-data-visually.html#cb539-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span>  </span>
<span id="cb539-4"><a href="exploring-your-data-visually.html#cb539-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Phe), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb539-5"><a href="exploring-your-data-visually.html#cb539-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb539-6"><a href="exploring-your-data-visually.html#cb539-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">y =</span> Phe), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb539-7"><a href="exploring-your-data-visually.html#cb539-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb539-8"><a href="exploring-your-data-visually.html#cb539-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Asparagine (mg/L)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Concentration (mg/L)&quot;</span>)</span></code></pre></div>
<p><img src="05-exploratory-dataviz_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<p>Based on its internal tests, <code>geom_smooth()</code> chooses what’s called a “spline” model–this is a way of fitting a wiggly curve to a set of points. It is a better way of describing the points we see, but may make worse predictions for points outside our x (Asn) value range.</p>
</div>
</div>
</div>
</div>
<div id="tidy" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Return to data wrangling - long vs wide<a href="exploring-your-data-visually.html#tidy" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Finally, we’re going to briefly return to the idea of tidy data. We’ve talked about this today and in previous classes, but hopefully experimenting with <code>ggplot2</code> has given some motivation to why we might want to use tidy data in many cases. We also showed some basic examples of moving from wide to narrow data by “tidying” our <code>apples</code> data frame into <code>tidy_apples</code>.</p>
<div id="making-data-tidy" class="section level3 hasAnchor" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Making data tidy<a href="exploring-your-data-visually.html#making-data-tidy" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In that operation we did the following:</p>
<ol style="list-style-type: decimal">
<li>Figure out what variable is spread across the columns: the <strong>amino acid names</strong>.</li>
<li>Check to make sure the data in all of those columns is the same: Yes! It is all “<strong>concentration</strong> of amino acid X” data.</li>
<li>Create two new columns to reorganize our data into:</li>
<li><code>amino_acids</code>. which has the name of the amino acid being measured, coming from the column names</li>
<li><code>concentration</code>, which has the concentration of the named amino acid, coming from the former column entries</li>
</ol>
<p>We did all this using the function <code>pivot_longer()</code>, which takes wide data and makes it long (and tidy). The anatomy of <code>pivot_wider()</code> is as follows:</p>
<ul>
<li><code>names_to = "&lt;where the former column names will go&gt;"</code>: in our case, we wrote <code>names_to = "amino_acid"</code>.</li>
<li><code>values_to = "&lt;where the former column entries will go&gt;"</code>: in our case, we wrote <code>values_to = "concentration"</code></li>
<li><code>-c(&lt;excluded columns&gt;)</code>: a vector of the columns that we don’t want to make longer, but instead want to keep track of. We wrote <code>-c(Variety, Rep)</code>.</li>
</ul>
<p>So the overall recipe was</p>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="exploring-your-data-visually.html#cb540-1" aria-hidden="true" tabindex="-1"></a>apples <span class="sc">%&gt;%</span></span>
<span id="cb540-2"><a href="exploring-your-data-visually.html#cb540-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">&quot;amino_acid&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;concentration&quot;</span>, <span class="sc">-</span><span class="fu">c</span>(Variety, Rep))</span></code></pre></div>
<pre><code>## # A tibble: 840 × 4
##    Variety        Rep   amino_acid concentration
##    &lt;chr&gt;          &lt;chr&gt; &lt;chr&gt;              &lt;dbl&gt;
##  1 Arkansas Black Rep_1 His                 0.62
##  2 Arkansas Black Rep_1 Asn                10.4 
##  3 Arkansas Black Rep_1 Ser                 0.68
##  4 Arkansas Black Rep_1 Gln                 1.6 
##  5 Arkansas Black Rep_1 Arg                 0.36
##  6 Arkansas Black Rep_1 Gly                 0.09
##  7 Arkansas Black Rep_1 Asp                 2.92
##  8 Arkansas Black Rep_1 Glu                 2.37
##  9 Arkansas Black Rep_1 Thr                 0.2 
## 10 Arkansas Black Rep_1 Ala                 0.72
## # … with 830 more rows
## # ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
<div id="making-data-wide" class="section level3 hasAnchor" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Making data wide<a href="exploring-your-data-visually.html#making-data-wide" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can also reverse the process, by using the <code>pivot_wider()</code> function. This literally reverses the operation. We need to specify two main arguments:</p>
<ol style="list-style-type: decimal">
<li><code>names_from = "&lt;current column&gt;"</code>: where the names for the new, wide columns will come from.</li>
<li><code>values_from = "&lt;current column&gt;"</code>: where the values that will go into the cells in the new columns will come from</li>
</ol>
<p>So to get back to <code>apples</code>, we can write:</p>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="exploring-your-data-visually.html#cb542-1" aria-hidden="true" tabindex="-1"></a>tidy_apples <span class="sc">%&gt;%</span></span>
<span id="cb542-2"><a href="exploring-your-data-visually.html#cb542-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;amino_acid&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;concentration&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 42 × 22
##    Variety     Rep     His   Asn   Ser   Gln   Arg   Gly   Asp   Glu   Thr   Ala
##    &lt;chr&gt;       &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 Arkansas B… Rep_1  0.62 10.4   0.68  1.6   0.36  0.09  2.92  2.37  0.2   0.72
##  2 Blacktwig   Rep_1  0.77  2.32  0.54  0     0.24  0     1.96  1.03  0.18  0.47
##  3 Empire      Rep_1  0.46 21.2   0.43  1.01  0.27  0.09  5.88  1.49  0.28  1.92
##  4 Enterprise  Rep_1  0.52 34.8   0.9   2.78  0.24  0.08  5.18  2.49  0.33  1.71
##  5 Field Red   Rep_1  0.85  4.02  0.29  0     0.41  0     1.87  1.29  0.19  0.33
##  6 Golden Del… Rep_1  0.56  1.01  0     0     0.34  0     1.76  0.98  0.32  0.26
##  7 Granny Smi… Rep_1  0.61  8.76  0.34  0     0.31  0.1   1.41  0.58  0.38  0.42
##  8 Newtown Pi… Rep_1  0.33 26.1   1.01  1.36  0.67  0.13  5.14  3.23  0.57  1.03
##  9 Northern S… Rep_1  0.51  2.52  0.17  0     0.23  0     1.6   1.05  0.35  0.34
## 10 Rome        Rep_1  0.36  1.57  0.2   0     0.43  0.08  1.23  0.91  0.34  0.23
## # … with 32 more rows, and 10 more variables: GABA &lt;dbl&gt;, Pro &lt;dbl&gt;, Cys &lt;dbl&gt;,
## #   Lys &lt;dbl&gt;, Tyr &lt;dbl&gt;, Met &lt;dbl&gt;, Val &lt;dbl&gt;, Ile &lt;dbl&gt;, Leu &lt;dbl&gt;, Phe &lt;dbl&gt;
## # ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names</code></pre>
<p>Note that, if your remaining variables (in this case, <code>Variety</code> and <code>Rep</code>) do not have unique combinations for each new column, <code>pivot_wider()</code> will give you a warning telling you that you’re trying to assign multiple variables to a single cell. This is a common error when you’re starting out:</p>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="exploring-your-data-visually.html#cb544-1" aria-hidden="true" tabindex="-1"></a>tidy_apples <span class="sc">%&gt;%</span></span>
<span id="cb544-2"><a href="exploring-your-data-visually.html#cb544-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Rep) <span class="sc">%&gt;%</span> <span class="co"># we get rid of Rep to make row IDs non-unique</span></span>
<span id="cb544-3"><a href="exploring-your-data-visually.html#cb544-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;amino_acid&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;concentration&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Values from `concentration` are not uniquely identified; output will contain list-cols.
## * Use `values_fn = list` to suppress this warning.
## * Use `values_fn = {summary_fun}` to summarise duplicates.
## * Use the following dplyr code to identify duplicates.
##   {data} %&gt;%
##     dplyr::group_by(Variety, amino_acid) %&gt;%
##     dplyr::summarise(n = dplyr::n(), .groups = &quot;drop&quot;) %&gt;%
##     dplyr::filter(n &gt; 1L)</code></pre>
<pre><code>## # A tibble: 14 × 21
##    Variety     His   Asn   Ser   Gln   Arg   Gly   Asp   Glu   Thr   Ala   GABA 
##    &lt;chr&gt;       &lt;lis&gt; &lt;lis&gt; &lt;lis&gt; &lt;lis&gt; &lt;lis&gt; &lt;lis&gt; &lt;lis&gt; &lt;lis&gt; &lt;lis&gt; &lt;lis&gt; &lt;lis&gt;
##  1 Arkansas B… &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  2 Blacktwig   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  3 Empire      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  4 Enterprise  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  5 Field Red   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  6 Golden Del… &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  7 Granny Smi… &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  8 Newtown Pi… &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  9 Northern S… &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 10 Rome        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 11 Shenandoah  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 12 Virginia G… &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 13 Winesap     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 14 York        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## # … with 9 more variables: Pro &lt;list&gt;, Cys &lt;list&gt;, Lys &lt;list&gt;, Tyr &lt;list&gt;,
## #   Met &lt;list&gt;, Val &lt;list&gt;, Ile &lt;list&gt;, Leu &lt;list&gt;, Phe &lt;list&gt;
## # ℹ Use `colnames()` to see all variable names</code></pre>
<p>This can either tell you you’ve incorrectly set up your pivot table or that you haven’t properly understood your data. The warning message produced has useful suggestions to figure out which of these might be the case.</p>
</div>
</div>
<div id="references-2" class="section level2 unnumbered hasAnchor">
<h2>References<a href="exploring-your-data-visually.html#references-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-bergstrom2021" class="csl-entry">
Bergstrom, Carl T., and Jevin D. West. 2021. <em>Calling <span>Bullshit</span></em>. <span>New York</span>: <span>Random House</span>.
</div>
<div id="ref-dignazio2020" class="csl-entry">
D’Ignazio, Catherine, and Lauren F. Klein. 2020. <em>Data <span>Feminism</span></em>. <span>Boston</span>: <span>MIT Press</span>.
</div>
<div id="ref-friendly2021" class="csl-entry">
Friendly, Michael, and Howard Wainer. 2021. <em>A <span>History</span> of <span>Data Visualization</span> and <span>Graphic Communication</span></em>. <span>Cambridge</span>: <span>Harvard University Press</span>.
</div>
<div id="ref-healy2019" class="csl-entry">
Healy, Kieran. 2019. <em>Data <span>Visualization</span>: <span>A Practical Introduction</span></em>. <span>Princeton</span>: <span>Princeton University Press</span>.
</div>
<div id="ref-ma2018a" class="csl-entry">
Ma, Sihui, Andrew P. Neilson, Jacob Lahne, Gregory M. Peck, Sean F. O’Keefe, and Amanda C. Stewart. 2018. <span>“Free Amino Acid Composition of Apple Juices with Potential for Cider Making as Determined by <span>UPLC-PDA</span>.”</span> <em>Journal of the Institute of Brewing</em> 124 (4): 467–76. <a href="https://doi.org/10.1002/jib.519">https://doi.org/10.1002/jib.519</a>.
</div>
<div id="ref-wickham2017" class="csl-entry">
Wickham, Hadley, and Garrett Grolemund. 2017. <em>R for <span>Data Science</span></em>. <span>Sebastopol</span>: <span>O’Reilly</span>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="wrangling-your-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="describing-your-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jlahne/food-data-science-2022/edit/master/05-exploratory-dataviz.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
